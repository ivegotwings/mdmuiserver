<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../bedrock-datasource-behavior/bedrock-datasource-behavior.html">

<script>
    /***
     * `RUFBehaviors.LOVDataSourceBehavior` provides common properties and methods that need to be implemented across all
     *  grid dataSource components. It is a mandatory behavior for all datasource components to implement.
     *
     *  ### Example
     *
     *     <dom-module id="x-lov-datasource">
     *        <template>
     *        </template>
     *        <script>
     *           Polymer({
     *             is: ""x-lov-datasource",
     *
     *             behaviors: [
     *               RUFBehaviors.DataSourceBehavior
     *             ],
     *
     *             properties: {
     *              
     *             }
     *           });
     *        &lt;/script>
     *     </dom-module>
     *
     * @polymerBehavior RUFBehaviors.LOVDataSourceBehavior
     */

    RUFBehaviors = RUFBehaviors || {};
    RUFBehaviors.LOVDataSourceBehavior = {

        properties: {
            _isResponseAttached: {
                type: Boolean,
                value: false
            },

            _isRequestInitiated: {
                type: Boolean,
                value: false
            }
        },

        checkIfRequestChanged: function () {
            var utils = SharedUtils.DataObjectFalcorUtil;
            var requestFilterExists = false;
            var lastRequestFilterExists = false;
            if (this.request && this.request.params && this.request.params.query.filters) {
                requestFilterExists = true;
            }
            if (this._lastRequest && this._lastRequest.params && this._lastRequest.params.query.filters) {
                lastRequestFilterExists = true;
            }
            if (requestFilterExists != lastRequestFilterExists) {
                return true;
            } else if (!requestFilterExists && !lastRequestFilterExists) {
                return true;
            }

            if (this.request.params.query.filters) {
                if (!utils.compareObjects(this.request.params.query.filters.keywordsCriterion, this._lastRequest
                    .params.query.filters.keywordsCriterion)) {
                    return true;
                }
                if (!utils.compareObjects(this.request.params.query.filters.typesCriterion, this._lastRequest
                    .params.query.filters.typesCriterion)) {
                    return true;
                }
                if (!utils.compareObjects(this.request.params.query.filters.attributesCriterion, this._lastRequest
                    .params.query.filters.attributesCriterion)) {
                    return true;
                }
            }
            if (!utils.compareObjects(this.request.params.sort, this._lastRequest
                .params.sort)) {
                return true;
            }
            return false;
        }
    };

    RUFBehaviors.LOVDataSourceBehavior = [RUFBehaviors.DataSourceBehavior, RUFBehaviors.LOVDataSourceBehavior];

</script>