<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<link rel="import" href="../pebble-image-viewer/pebble-image-viewer.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-horizontal-divider/pebble-horizontal-divider.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">


<!--
`<rock-notification-list>` Represents an element that displays all the notifications as a list.

### Example

    <rock-notification-list notifications="jsonData" show-line-index="1"></rock-notification-list>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--notification-image-size` | The notification image width and height | 40px
`--notification-item-max-width` | The notification item max width | `250px`
`--notification-item-max-height` | The notification item max height | `60px`
`--notification-item-padding` | The notification item padding | `2px`
`--notification-font-size` | The notification item font size | `12px`
`--notification-margin-bottom` | The notification item bottom margin | `10px`
`--notification-container-styles` | Mixin applied to the notification item container | `{}`
`--image-box-styles` | Mixin applied to the image box | `{}`
`--when-box-styles` | Mixin applied to the when box | `{}`
`--desc-box-styles` | Mixin applied to the description box | `{}`
`--profile-flex-verticle-max-width` | The notification "when" and "description" items verticle max width | `180px`

@group rock Elements
@element rock-notification-list
@demo demo/index.html
-->

<dom-module id="rock-notification-list">
  <template>
    <style is="custom-style" include="iron-flex iron-flex-alignment pebble-styles-shared">
      /*For sizing the image*/
      
      .thumb-image {
        width: var(--notification-image-size, 40px);
        height: var(--notification-image-size, 40px);
      }
      /*Profile container style*/
      
      .container {
        @apply(--notification-container-styles);
        padding: 5px 20px;
        /*width:522px;*/
        position:relative;
      }
      /*For Image*/
      
      .img-box {
        width: var(--notification-image-box-width, 20px);
        @apply(--image-box-styles);
      }
      /*For Name*/
      
      .when-box {
        color: var(--notification-when-color, #928d8d);
        @apply(--when-box-styles);
        display: inline-block;
        font-size: 12px !important;
      }
      /*For Description*/
      
      .desc-box {
        color: var(--notification-desc-color, #000000);
        display: inline-block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        width: 405px;
        text-align: left;
        vertical-align: middle;
      }
      /*Notification horizontal div styles*/
      
      .flex-horizontal {
        @apply(--layout-horizontal);
      }
      /*Notification verticle div styles*/
      
      .flex-vertical {
        max-width: var(--profile-flex-verticle-max-width, 333px);
        padding-top:2px;
        /*width:489px;*/
      }
      
      /*.flex-vertical:hover {
        background-color: var(--dropdown-selection-bg, #eaf3fc);
        border: 0px solid var(--mdm-primary-color, #036bc3);
      }*/
      
      /*Notification content style*/
      
      .box {
        display: flex;
        display: -webkit-flex;
        /* Safari */
        justify-content: left;
        -webkit-justify-content: left;
        align-items: center;
        -webkit-align-items: center;
        /* Safari 7.0+ */
        align-content: left;
        -webkit-align-content: left;
        font-size: 14px;
        line-height: 25px;
      }
      
      pebble-horizontal-divider {
        background-color: var(--palette-pale-grey-three, #e7ebf0);
        margin-right: 20px;
        margin-left: 20px      
        }
      
      pebble-icon::shadow iron-icon {
        color: var(--primary-icon-color, #75808b);
      }
      
      .btn {
        float: right;
        font-size: 12px;
        line-height: 1.5;
        color: #036bc3;
        padding: 5px 20px 10px 20px;
      }
      .btn::shadow paper-button{
         padding: 0px;
         font-weight: normal;
        }

      .popup-title{
        margin: 0px;
        font-size: var(--default-font-size, 14px);
        font-weight: var(--font-medium, 500);
        padding:10px 20px;
      }
      p.notification-msg{
        text-align: left;
        margin:0 !important;
        padding:5px 20px;
        font-size: var(--default-font-size, 14px);
        color: var(--toast-font-color, #4b4e51);
      }
      ul.notification-msgs{
        text-align: left;        
        margin:0 !important;
        font-size: var(--default-font-size, 14px);
        color: var(--toast-font-color, #4b4e51);
      }
      
      ul.notification-msgs li{
        font-size: var(--default-font-size, 14px);
        font-family: var(--default-font-family);
        color: var(--toast-font-color, #4b4e51);
        list-style-type: disc;
      }
    </style>

    <template is="dom-if" if="{{!_isNotificationAvailable(notifications)}}">
      
      <h4 class="popup-title">You don't have any notifications yet.</h4>
      <p class="notification-msg">New notifications will appear here when:</p>
      <ul class="notification-msgs">
        <li>You are assigned new tasks as per workflow processes</li>
        <li>Items you are worked on have errors/warnings</li>
        <li>Other users share tasks/content with you</li>
      </ul>
    </template>

    <template is="dom-if" if="{{_isNotificationAvailable(notifications)}}">
      <template is="dom-repeat" items="{{notifications}}">
        <template is="dom-if" if="[[_showLine(index)]]"></template>
        <div class="container flex-horizontal">
          <!-- Image section -->
          <div class="img-box box">
            <pebble-icon icon="pebble-icons:Comment"></pebble-icon>
            <!--<pebble-image-viewer src="[[item.src]]" alt="text" shape="circle" sizing="contain" class="thumb-image"></pebble-image-viewer>-->
          </div>
          <!-- when & description section -->
          <div class="flex-vertical">
            <div class="desc-box">
              [[item.desc]]
            </div>
            <div class="when-box">
              [[item.when]]
            </div>
            <pebble-icon icon="pebble-icons:Collapse"></pebble-icon>
          </div>
        </div>
        <pebble-horizontal-divider></pebble-horizontal-divider>
      </template>
      <div>
        <pebble-button class="btn btn-link" button-text="CLEAR ALL" on-tap="_onClearNotifications">
        </pebble-button>
      </div>
    </template>

  </template>
  <script>
    Polymer({
      is: 'rock-notification-list',

      properties: {

        /**
         *  Indicates the list of notifications in the JSON format.
        */
        notifications: {
          type: Array,
          notify: true,
          value: []
        },

        /*
         *  Indicates an index to show a line above the specified item.
        */
        showLineIndex: {
          type: Number,
          value: -1
        }

      },

      /*Show a line above an item in the list*/
      _showLine: function (index) {
        return index == this.showLineIndex;
      },

      _isNotificationAvailable: function (notifications) {
        if (notifications.length) {
          return true
        }
        return false;
      },

      _onClearNotifications: function () {
        this.notifications = [];
        var mainApp = document.querySelector('main-app');
        if (mainApp) {
          var notificationBadge = mainApp.$$('rock-notification');

          if (notificationBadge) {
            notificationBadge.label = 0;
          }
        }
      }
    });
  </script>
</dom-module>