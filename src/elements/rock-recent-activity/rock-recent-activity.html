<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/polymer/lib/elements/custom-style.html">
<link rel="import" href="../../../bower_components/iron-list/iron-list.html">
<link rel="import" href="../../../bower_components/iron-scroll-threshold/iron-scroll-threshold.html">

<link rel="import" href="../pebble-spinner/pebble-spinner.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<link rel="import" href="../bedrock-component-context-behavior/bedrock-component-context-behavior.html">
<link rel="import" href="../bedrock-style-manager/styles/bedrock-style-common.html">

<link rel="import" href="../rock-widget-panel/rock-widget-panel.html">



<!--
`<rock-entity-summary>` Represents an element that renders the widgets 
such as "to-do" and "to-fix" for an entity.

### Example

    <template is="dom-bind" id="demo-app">				
				<rock-entity-summary config="{{config}}"></rock-entity-summary>
		</template>

@group rock Elements
@element rock-entity-summary
@demo demo/index.html
-->

<dom-module id="rock-recent-activity">
  <template>
      <style include="bedrock-style-common bedrock-styles-scroll-bar"></style>
      <style include="iron-flex"></style>
          <style>
              .loadingIndicator {
                  position: relative;
                  text-align: center;
              }
              .item-wrapper{
                padding:30px 0px;
              }
              #scrollingArea {
                    height: var(--rock-grid-height, 400px);
                    overflow: auto;
                    -webkit-overflow-scrolling: touch;
                    border-radius: 3px;
                    @apply --grid-list-view-scrollingRegion;
                }
              .status-icon{                
                background-color: var(--success-button-color, #09c021);
                border-radius: 50%;
                width: 30px;
                height: 30px;
                display: -ms-flex;
                display: inline-flex;
                display: -webkit-inline-flex;
                vertical-align: top;
                align-items: center;
                justify-content: center;              
              }
              .status-icon pebble-icon {
                --pebble-icon:{
                  fill:#fff;
                }
              }
          </style>
    <div id="scrollingArea">
      <iron-list id="list" items="{{items}}" as="item" scroll-target="html" selection-enabled>
          <template>
            <div class="item-wrapper">[[item]]           
        </div>  
          </template>
      </iron-list>
    </div>
      <div class="loadingIndicator">
          <pebble-spinner active="[[loading]]"></pebble-spinner>
      </div>
      <iron-scroll-threshold id="scrollTheshold" on-lower-threshold="_loadMoreData" scroll-target="scrollingArea">
      </iron-scroll-threshold>
  </template>
  <script>
    (function () {
      'use strict';

      Polymer({
        is: 'rock-recent-activity',
        properties: {
          /**
           * Specifies the widget-panel config used for the "summary" dashboard.
           */
          config: {
            type: Object,
            value: function () {
              return {};
            }
          },
          /**
           * If set as true , it indicates the component is in read only mode
           */
           loading: {
              type: Boolean,
              value: false		
          },
          /**
            * <b><i>Content development is under progress... </b></i> 
            */
            items: {
              type: Array,
              value: function () {
                  return [];
              }
          },
          conItems:{
            type:Array,
            value:function(){
              return ["balaji1","balaji2","balaji3","balaji4","balaji5","balaji6","balaji7","balaji8","balaji9","balaji10"]
            }
          }
        },
        behaviors: [
          RUFBehaviors.ComponentContextBehavior
        ],
        ready:function(){  
          this._setListHeight();  
          this.items = this.conItems;
        },
        _setListHeight:function(){
          if(this.getBoundingClientRect().y > 0){
            var scrollHeight = window.innerHeight-this.getBoundingClientRect().y - 20;
            // 20 pebble tab margin bottom height;
            this.updateStyles({  
              "--rock-grid-height":scrollHeight+"px"
            });  
          }
        },
        _loadMoreData:function(){
          var items= this.items;
          var conItems = this.conItems;
          var finalItems = items.concat(conItems);
          this.set('items',finalItems)
          this.$.scrollTheshold.clearTriggers();
        },
        refresh: function () {
         
        }
      });
    })();
  </script>
</dom-module>