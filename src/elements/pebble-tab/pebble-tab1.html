<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">

<link rel="import" href="../../../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">

<dom-module id="pebble-tab1">
    <template>
        <template is="dom-repeat" items="[[data.config.tabItems]]" as="tabItem">
            <paper-menu-button>
              <paper-icon-button icon="menu" class="dropdown-trigger"></paper-icon-button>
              <paper-menu class="dropdown-content">
                  <paper-item>Share</paper-item>
                  <paper-item>Settings</paper-item>
                  <paper-item>Help</paper-item>
              </paper-menu>
           </paper-menu-button>
        </template>
    </template>
</dom-module>

<script>

    (function() {
      'use strict';

      Polymer({
        is: 'pebble-tab1',
        behaviors: [
          Polymer.IronA11yKeysBehavior,
          Polymer.IronControlState
        ],
        properties: {
            data: {
                type: Object,
            },
            opened: {
                type: Boolean,
                value: false,
                notify: true,
                observer: '_openedChanged'
            },
         
            horizontalAlign: {
                type: String,
                value: 'left',
                reflectToAttribute: true
            },
        
            verticalAlign: {
                type: String,
                value: 'top',
                reflectToAttribute: true
            },

            /**
             * If true, the `horizontalAlign` and `verticalAlign` properties will
             * be considered preferences instead of strict requirements when
             * positioning the dropdown and may be changed if doing so reduces
             * the area of the dropdown falling outside of `fitInto`.
             */
            dynamicAlign: {
                type: Boolean
            },

            /**
             * A pixel value that will be added to the position calculated for the
             * given `horizontalAlign`. Use a negative value to offset to the
             * left, or a positive value to offset to the right.
             */
            horizontalOffset: {
                type: Number,
                value: 0,
                notify: true
            },

            /**
             * A pixel value that will be added to the position calculated for the
             * given `verticalAlign`. Use a negative value to offset towards the
             * top, or a positive value to offset towards the bottom.
             */
            verticalOffset: {
                type: Number,
                value: 0,
                notify: true
            },

            /**
             * If true, the dropdown will be positioned so that it doesn't overlap
             * the button.
             */
            noOverlap: {
                type: Boolean
            },

            /**
             * Set to true to disable animations when opening and closing the
             * dropdown.
             */
            noAnimations: {
                type: Boolean,
                value: false
            }
        },

        ready: function() {
        },

        _isScrollable: function(isScrollable) {
            if(isScrollable) {
                return true;
            } else  {
                return false;
            }
        },

        _isSelected: function(tabItems){
            if(tabItems != null && tabItems != undefined && tabItems.length > 0) {
                for(var tabItemIndex in tabItems){
                    if(tabItems[tabItemIndex].selected) {
                        return tabItemIndex;
                    }
                }
            }

            return "0"; // default selected tab
        },

        /**
         * When the dropdown opens, the `paper-menu-button` fires `paper-open`.
         * When the dropdown closes, the `paper-menu-button` fires `paper-close`.
         *
         * @param {boolean} opened True if the dropdown is opened, otherwise false.
         * @param {boolean} oldOpened The previous value of `opened`.
         */

        _openedChanged: function(opened, oldOpened) {
          if (opened) {
            // TODO(cdata): Update this when we can measure changes in distributed
            // children in an idiomatic way.
            // We poke this property in case the element has changed. This will
            // cause the focus target for the `iron-dropdown` to be updated as
            // necessary:
            this._dropdownContent = this.contentElement;
            this.fire('paper-dropdown-open');
          } else if (oldOpened != null) {
            this.fire('paper-dropdown-close');
          }
        },

        /**
         * The content element that is contained by the menu button, if any.
         */
        get contentElement() {
          return Polymer.dom(this.$.content).getDistributedNodes()[0];
        },

        /**
         * Toggles the drowpdown content between opened and closed.
         */
        toggle: function() {
          if (this.opened) {
            this.close();
          } else {
            this.open();
          }
        },

        /**
         * Make the dropdown content appear as an overlay positioned relative
         * to the dropdown trigger.
         */
        open: function() {
          if (this.disabled) {
            return;
          }

          this.$$("#dropdown").open();
        },

        /**
         * Hide the dropdown content.
         */
        close: function() {
          this.$$("#dropdown").close();
        },

        listeners: {
          'iron-activate': '_onIronActivate',
          'iron-select': '_onIronSelect'
        },

        /**
         * When an `iron-select` event is received, the dropdown should
         * automatically close on the assumption that a value has been chosen.
         *
         * @param {CustomEvent} event A CustomEvent instance with type
         * set to `"iron-select"`.
         */
        _onIronSelect: function(event) {
          if (!this.ignoreSelect) {
            this.close();
          }
        },

        /**
         * Closes the dropdown when an `iron-activate` event is received if
         * `closeOnActivate` is true.
         *
         * @param {CustomEvent} event A CustomEvent of type 'iron-activate'.
         */
        _onIronActivate: function(event) {
          if (this.closeOnActivate) {
            this.close();
          }
        },

        /**
         * If the dropdown is open when disabled becomes true, close the
         * dropdown.
         *
         * @param {boolean} disabled True if disabled, otherwise false.
         */
        _disabledChanged: function(disabled) {
          Polymer.IronControlState._disabledChanged.apply(this, arguments);
          if (disabled && this.opened) {
            this.close();
          }
        },

        __onIronOverlayCanceled: function(event) {
          var uiEvent = event.detail;
          var target = Polymer.dom(uiEvent).rootTarget;
          var trigger = this.$.trigger;
          var path = Polymer.dom(uiEvent).path;

          if (path.indexOf(trigger) > -1) {
            event.preventDefault();
          }
        }
      });
    })();

</script>

<script>
        
</script>