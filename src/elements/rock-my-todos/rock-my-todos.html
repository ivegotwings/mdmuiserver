<link rel="import" href="../rock-elements/rock-elements.html">
<link rel="import" href="./my-todo-summary-list.html">
<link rel="import" href="./my-todo-detail-view-list.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="rock-my-todos">
    <template>
        <style include="pebble-styles-shared"></style>

        <iron-ajax auto url="../../data/my-todos-summary.json" handle-as="json" last-response="{{myTodos}}"></iron-ajax>
            <rock-tabs config="{{_tabConfig}}" selected-tab-index = "{{_selectedTabIndex}}"></rock-tabs>
    </template>

    <script>

(function() {
  'use strict';
  Polymer({

    is: 'rock-my-todos',

    properties: {

        /**
         * internal Property denoting the selected index of a tab
         */
         _selectedTabIndex: {
            type: Number,
             value: 0,
             observer: '_dataChanged'
         },

        /**
         * This property represents the list of my-todos that needs to be displayed in rock-my-todos widget.
         */
        myTodos : {
            type : Array,
             notify: true,
             reflectToAttribute: true,
             value: [],
             observer : '_dataChanged'
        },

          /**
          * This is an internal property. Contains the config for tabs
          */
         _tabConfig : {
            type:Object,
             notify: true,
            value:function(){
                return {
                        "fitContainer": false,
                        "scrollable": false,
                        "tabItems": [
                            {
                                "name": "summary",
                                "title": "Summary View",
                                "enableDropdownMenu": false,
                                "selected" : true,
                                "component": {
                                    "name": "my-todo-summary-list",
                                    "path": "/src/elements/rock-my-todos/my-todo-summary-list.html",
                                    "properties": {

                                    }
                                }
                            },
                             {
                                "name": "detail",
                                "title": "Detail View",
                                "enableDropdownMenu": false,
                                "component": {
                                    "name": "my-todo-detail-view-list",
                                    "path": "/src/elements/rock-my-todos/my-todo-detail-view-list.html",
                                    "properties": {

                                    }
                                }
                            }
                        ]
                }
            }
         }


        },

        /**
         * This is an internal function, invoked when there is any change in the my-todos list.
         */
        _dataChanged : function() {
            if(this._tabConfig) {
                this._tabConfig.tabItems[this._selectedTabIndex].component.properties.list=this.myTodos;
            }
        }

    });
  })();

</script>
</dom-module>