<link rel="import" href="../../pebble-image-viewer/pebble-image-viewer.html">
<dom-module id="my-todo-product-view">
    <template>
        <style include="shared-styles"></style>
        <style>
            .input-panel {
				width: 100%;
				@apply(--layout-horizontal);
				@apply(--layout-center);
			}

            .item-container{
                /*border: #D2D7DD 1px solid;*/
               border-radius: 3px;
                margin :1% 2%;
                border: #838D97 1px solid;
                color: #1A2028;
                height:70px;
                width:95%;
            }

             #image-container {
                width: 60px;
                height: 50px;
                background: #ddd;
                margin : 10px;
            }

            .content-div {
                width: 72%;
            }

            .last-div {
            }

             .to-do-name {
                //font-size:20px;
                font-weight: 500;
                width : 200px;
                text-overflow: ellipsis;
                overflow: hidden;
            }

            .to-do-body {
                color:#838D97
            }

            .text-style {
                width : 200px;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        </style>

        <div class="input-panel item-container" on-tap="_onTapEvent">
            <pebble-image-viewer alt="Product image." id = "image-container" sizing="contain" src="{{product.imageUrl}}"></pebble-image-viewer>
            <div class="content-div">
                <div class="to-do-name">{{_displayName(product.name)}}</div>
                <div class="to-do-body">#{{product.id}}</div>
            </div>
            <div class="last-div to-do-body">
                <div class="text-style">{{product.vendorName}}</div>
                <div class="text-style">{{_ComputePath(product.categoryPath)}}</div>
            </div>

        </div>



    </template>

    <script>

    Polymer({

    is: 'my-todo-product-view',

    properties: {

       /**
        * Fired when any of the product within my-todo is tapped in my-todo's widget with event name: "rock-my-todo-product-click" and data is the data of the clicked product
        *
        * @event bedrock-event
        */
        /**
         * This property represents the product data.
         */
        product : {
            type : Object,
            notify : true,
            reflectToAttribute : true,
            value : {}
        }
    },

    /**
     *  This is an internal function, used to display category path
     */
    _ComputePath : function(categoryPath) {
        if(categoryPath) {
            var s = categoryPath.split('/');
            var path = '' + s[1];
            for(var i = 2; i < s.length; i++) {
                path = path + ' >> ' + s[i];
            }
            if(path.length > 20) {
                path = path.substring(0,20) + '...'
            }
            return path;
        }
        return '';
    },

    /**
     *  This is an internal function. If the name of the product exceeds 20 characters, it displays first 20 characters and ...
     */
    _displayName(productName) {
        var displayName = '';
        if(productName && productName.length > 20) {
            displayName = productName.substring(0,20) + '...'
        }

        return displayName;
    },

    /**
     * This is internal function used to fire an rock-my-todo-product-click when any product in my-todo element is tapped
     */
    _onTapEvent : function(e) {
        var eventData = {
                name : "rock-my-todo-product-click",
                data : this.product
            }
            this.fire('bedrock-event',eventData)
    }
   });

</script>
</dom-module>