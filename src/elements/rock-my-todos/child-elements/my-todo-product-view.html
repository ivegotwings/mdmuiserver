<link rel="import" href="../../../../bower_components/shadycss/apply-shim.html">
<!--
<b><i>Content development is under progress... </b></i>

@demo demo/index.html
-->
<dom-module id="my-todo-product-view">
    <template>
        <style include="bedrock-style-common"></style>
        <style>
            .input-panel {
                width: 100%;
                cursor: var(--input-panel-cursor, pointer);
                @apply --layout-horizontal;
                @apply --layout-center;
            }
            
            /*.item-container {
                border: #D2D7DD 1px solid;
                border-radius: 3px;
                margin: 1% 2%;
                border: #838D97 1px solid;
                color: #1A2028;
                height: 70px;
                width: 95%;
            }*/
            
            #image-container {
                width: 60px;
                height: 40px;
                background: #ddd;
                margin: var(--default-list-spacing,8px);
                border-radius:var(--default-border-radius);
            }
            
            .content-div {
                width: calc( 100% - 200px);
            }
            
            .to-do-name {
                /*font-weight: var(--font-medium, 500);*/
                width: 200px;
                text-overflow: ellipsis;
                overflow: hidden;
            }
            
            .text-style {
                width: 135px;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        </style>
        <div class="input-panel list-content list-item" on-tap="_onTapEvent">
            <img alt="Product image." id="image-container" src="[[product.imageUrl]]"/>
            <div class="content-div">
                <div class="to-do-name block-text">{{_displayName(product.name)}}</div>
                <div class="to-do-body">#{{product.id}}</div>
            </div>
            <div class="last-div to-do-body sub-content text-right m-r-10">
                <div class="text-style">{{product.vendorName}}</div>
                <div class="text-style">{{_ComputePath(product.categoryPath)}}</div>
            </div>
        </div>
    </template>
    <script>
        Polymer({

            is: 'my-todo-product-view',

            properties: {

                /**
                 * Fired when a product within `my-todo` is tapped in `my-todo`'s widget along with the event such as `rock-my-todo-product-click` and "clicked" product's data.
                 *
                 * @event bedrock-event
                 */
                /**
                 * Indicates the product data.
                 */
                product: {
                    type: Object,
                    notify: true,
                    value: {}
                }
            },

            /**
             *  This is an internal function, used to display category path
             */
            _ComputePath: function (categoryPath) {
                if (categoryPath) {
                    var s = categoryPath.split('/');
                    var path = '' + s[1];
                    for (var i = 2; i < s.length; i++) {
                        path = path + ' Â» ' + s[i];
                    }
                    if (path.length > 20) {
                        path = path.substring(0, 20) + '...'
                    }
                    return path;
                }
                return '';
            },

            /**
             *  This is an internal function. If the name of the product exceeds 20 characters, it displays first 20 characters and ...
             */
            _displayName(productName) {
                var displayName = '';
                if (productName && productName.length > 20) {
                    displayName = productName.substring(0, 20) + '...'
                }

                return displayName;
            },

            /**
             * This is internal function used to fire an rock-my-todo-product-click when any product in my-todo element is tapped
             */
            _onTapEvent: function (e) {
                var eventData = {
                    name: "rock-my-todo-product-click",
                    data: this.product
                }
                this.dispatchEvent(new CustomEvent('bedrock-event', {detail:eventData,bubbles:true,composed:true}))
            }
        });
    </script>
</dom-module>