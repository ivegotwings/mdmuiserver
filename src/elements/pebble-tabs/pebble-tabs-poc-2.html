<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">

<link rel="import" href="../../../bower_components/iron-dropdown/iron-dropdown.html">
<link rel="import" href="../../../bower_components/iron-pages/iron-pages.html">

<link rel="import" href="../pebble-tab/pebble-tab.html">

<dom-module id="pebble-tabs">
    <template>
        <paper-tabs selected="{{selected}}" scrollable="[[_isScrollable(data.config.scrollable)]]" defaultSelectedTab="{{}}">
            <template is="dom-repeat" items="[[data.config.tabItems]]" as="tabItem">
                <!--<paper-tab noink>[[tabItem.text]]</paper-tab>-->
                
                <pebble-tab id="[[tabItem.name]]" noink>
                    <div class="tab-content">
                        <iron-icon icon="[[tabItem.icon]]" style="margin-right: 0.4em"></iron-icon>
                        [[tabItem.text]]
                    </div>

                    <paper-menu class="dropdown-content">
                        <template is="dom-repeat" items="[[tabItem.menuItems]]" as="menuItem">
                            <paper-item>[[menuItem.text]]</paper-item>
                        </template>
                    </paper-menu>
                </pebble-tab>
            </template>
        </paper-tabs>

        <iron-pages selected="{{selected}}">
            <div>Page 1</div>
            <div>Page 2</div>
            <div>Page 3</div>
        </iron-pages>
    </template>

    <script>

        (function() {
        'use strict';

        Polymer({
            is: 'pebble-tabs',
            properties: {
                data: {
                    type: Object,
                    notify: true
                },
                selected: {
                    type: Number,
                    value: 0,
                    notify: true
                }
            },

            attached: function() {
                this.selected = this._getDefaultSelectedTab(this.data);
            },

            _getDefaultSelectedTab: function(tabItems){
                // var tabItems = this.data.config.tabItems;

                if(tabItems != null && tabItems != undefined && tabItems.length > 0) {
                    for(var tabItemIndex in tabItems){
                        if(tabItems[tabItemIndex].selected) {
                            console.log(tabItemIndex);
                            return tabItemIndex;
                        }
                    }
                }

                return "0"; // default selected tab
            },

            _isScrollable: function(isScrollable) {
                if(isScrollable) {
                    return true;
                } else  {
                    return false;
                }
            }
            
        });
        })();

    </script>
</dom-module>

<script>
        // <paper-tabs selected="[[_isSelected(data.config.tabItems)]]" scrollable="[[_isScrollable(data.config.scrollable)]]" >
        //     <template is="dom-repeat" items="[[data.config.tabItems]]" as="tabItem">
                
        //         <paper-tab id="[[tabItem.name]]" noink>
        //             <!-- Below added style must be removed -->
        //             <iron-icon icon="[[tabItem.icon]]" style="margin-right: 0.4em"></iron-icon>
        //             [[tabItem.text]]
        //             <paper-icon-button id="[[tabItem.name]]_[[_suffix.dropdownButton]]" icon="icons:more-vert" on-tap="toggle" style="margin-left: 0.4em">
        //             </paper-icon-button>
        //         </paper-tab>
                
        //         <iron-dropdown id="[[tabItem.name]]_[[_suffix.dropdown]]" opened="{{opened}}" focus-target="[[_dropdownContent]]">
        //             <paper-menu id="[[tabItem.name]]_[[_suffix.dropdownContent]]" class="dropdown-content">
        //                 <template is="dom-repeat" items="[[tabItem.menuItems]]" as="menuItem">
        //                     <paper-item>[[menuItem.text]]</paper-item>
        //                 </template>
        //             </paper-menu>
        //         </iron-dropdown>

        //     </template>
        // </paper-tabs>

        

        // <paper-tab id="[[tabItem.name]]" noink>
        //                 <!-- Below added style must be removed -->
        //                 <iron-icon icon="[[tabItem.icon]]" style="margin-right: 0.4em"></iron-icon>
        //                 [[tabItem.text]]
        //                 <paper-icon-button id="[[tabItem.name]]_[[_suffix.dropdownButton]]" icon="icons:more-vert" on-tap="toggle" style="margin-left: 0.4em">
        //                 </paper-icon-button>
        //         </paper-tab>
</script>