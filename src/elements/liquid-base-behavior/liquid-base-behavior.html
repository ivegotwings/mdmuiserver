<link rel="import" href="../../../bower_components/polymer/polymer.html">
<script>
    /*
    * @demo demo/index.html
    * @polymerBehavior RUFBehaviors.LiquidBaseBehavior
    */
    var RUFBehaviors = RUFBehaviors || {};
    RUFBehaviors.LiquidBaseBehavior = {
        /**
         * This is to hide the current element from the dom 
         */
        hostAttributes: {
            hidden: true
        },
        attached: function () { },
        ready: function () { },
        properties: {
            /**
             * If true, automatically performs an Ajax request when either `url` or
             * `params` changes.
             */
            auto: {
                type: Boolean,
                value: false
            },
            /**
             * The most recent request made by this iron-ajax element.
             */
            lastRequest: {
                type: Object,
                value: function(){
                    return {};
                },
                notify: true,
                readOnly: true
            },
            /**
             * True while lastRequest is in flight.
             */
            loading: {
                type: Boolean,
                notify: true,
                readOnly: true
            },
            /**
             * lastRequest's response.
             *
             * Note that lastResponse and lastError are set when lastRequest finishes,
             * so if loading is true, then lastResponse and lastError will correspond
             * to the result of the previous request.
             *
             * The type of the response is determined by the value of `handleAs` at
             * the time that the request was generated.
             *
             * @type {Object}
             */
            lastResponse: {
                type: Object,
                value: function(){
                    return {};
                },
                notify: true,
                readOnly: true
            },
            /**
             * lastRequest's error, if any.
             *
             * @type {Object}
             */
            lastError: {
                type: Object,
                value: function(){
                    return {};
                },
                notify: true,
                readOnly: true
            },
            /**
             * An Array of all in-flight requests originating from this iron-ajax
             * element.
             */
            activeRequests: {
                type: Array,
                value: function () {
                    return [];
                },
                notify: true,
                readOnly: true,
            },
            /**
             * Length of time in milliseconds to debounce multiple automatically generated requests.
             */
            debounceDuration: {
                type: Number,
                value: 0,
                notify: true
            },
            /**
             * By default, liquid-element-*'s events bubble. Setting this attribute will cause its
             * request and response events as well as its iron-ajax-request, -response,  and -error
             * events to bubble to the window object. The vanilla error event never bubbles when
             * using shadow dom even if this.bubbles is true because a scoped flag is not passed with
             * it (first link) and because the shadow dom spec did not used to allow certain events,
             * including events named error, to leak outside of shadow trees (second link).
             * https://www.w3.org/TR/shadow-dom/#scoped-flag
             * https://www.w3.org/TR/2015/WD-shadow-dom-20151215/#events-that-are-not-leaked-into-ancestor-trees
             */
            bubbles: {
                type: Boolean,
                value: true
            },
            /**
             * If true, error messages will automatically be logged to the console.
             */
            verbose: {
                type: Boolean,
                value: false
            },
            /**
             * Set the timeout flag on the request.
             */
            timeout: {
                type: Number,
                value: 0
            },
            requestData: {
                type: Object,
                value: function () {
                    return {};
                },
                notify: true
            },
            /**
             * Prefix to be stripped from a JSON response before parsing it.
             *
             * In order to prevent an attack using CSRF with Array responses
             * (http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx/)
             * many backends will mitigate this by prefixing all JSON response bodies
             * with a string that would be nonsensical to a JavaScript parser.
             *
             */
            _jsonPrefix: {
                type: String,
                value: ''
            }
        },
        generateRequest: function () {
            //abstract method....do nothing...all elements implementing this behavior must implement this method
        }
    };
</script>