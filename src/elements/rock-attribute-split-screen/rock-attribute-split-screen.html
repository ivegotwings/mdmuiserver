<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../rock-attribute-manage/rock-attribute-manage.html">
<link rel="import" href="../pebble-vertical-divider/pebble-vertical-divider.html">
<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<dom-module id="rock-attribute-split-screen">
	<template>
		<style>
			.attribute-list {
				display: inline-flex;
				/*border: 1px solid black;*/
			}
			
			.attribute-list-1 {
				width: 100%;
			}
			
			.attribute-list-2 {
				width: 49%;
			}
			
			.attribute-list-3 {
				width: 33%;
			}
			
			.attribute-list-4 {
				width: 24%;
			}
			
			.dimension {
				width: 100%;
				@apply(--layout);
				@apply(--layout-horizontal);
				border-bottom: 1px solid #ccc;
			}
			
			#actions {
				--pebble-button: {
					height: 30px;
					padding: 1em 0em 1em 0.2em;
					color: #212121;
					border: 1px solid #C1CAD4;
					font-size: small;
					margin-left: -3px;
				}
			}
			
			#dimensionValueContainer {
				margin-left: 20px;
				margin-top: auto;
			}
			
			pebble-icon {
				color: #ff4081;
			}
			
			.attributeList {
				width: 96%;
			}
			
			.divider {
				width: 2%;
			}
			
			pebble-vertical-divider {
				--pebble-vertical-divider-color: #1a2028;
				height: 100%;
				border: 0px;
				min-height: 0px;
			}
		</style>
		<div class="dimension" style$="[[_getStyle(noOfScreens)]]">
			<template is="dom-repeat" items="[[locales]]">
				<div id="dimensionValueContainer" class$="[[_getAttributeListClass(noOfScreens)]]">
					<pebble-icon icon="pebble-icons:Language"></pebble-icon>
					[[item.language]]
				</div>
			</template>
			<div align="right">
				<pebble-button id="actions" icon="pebble-icons:Done" button-text="Actions" noink elevation="2" dropdown-icon on-tap="_onActionsTap"></pebble-button>
			</div>
		</div>
		<template is="dom-repeat" items="[[locales]]">
			<div class$="[[_getAttributeListClass(noOfScreens)]]">
				<div class="attributeList">
					<rock-attribute-manage mode="[[mode]]" no-of-columns="[[_computeColumns(noOfScreens)]]" locale="[[item.locale]]" context="[[context]]"
									source="[[source]]" list="[[list]]"></rock-attribute-manage>
				</div>
				<div class="divider" style$="[[_getStyle(noOfScreens)]]" align="right" hidden$="{{_isHidden(item)}}">
					<pebble-vertical-divider></pebble-vertical-divider>
				</div>
			</div>
		</template>
	</template>
	<script>
		Polymer({
			is: "rock-attribute-split-screen",

			properties: {
				noOfScreens: {
					type: Number,
					computed: '_computeScreens(locales)'
				},

				context: {
					type: Object,
					value: function () {
						return {};
					}
				},

				noOfColumns: {
					type: Number,
				},

				mode: {
					type: String,
				},

				list: {
					type: String
				},

				source: {
					type: String
				},

				locales: {
					type: Array,
					value: [{
						"locale": "en-US",
						"language": "English"
					}]
				},
			},

			_getAttributeListClass: function (n) {
				return "attribute-list attribute-list-" + n;
			},

			_isHidden: function () {
				if (this.locales.length == 1)
					return true;
			},

			_computeScreens: function (locales) {
				return locales.length;
			},

            _computeColumns: function(noOfScreens) {
                if(noOfScreens > 1) {
                    return 1;
                }
                else{
                    return this.noOfColumns;
                }
            },
            _getStyle: function(n) {
                if(n == 1){
                    return "display: none";
                }
                else{
                    return "";
                }
            },
            _onActionsTap: function() {
                alert("actions tapped");
            },
            _isHidden: function(item) {
                var index = this.locales.indexOf(item);
                if(index == this.noOfScreens-1) {
                    return true;
                }
                return false;
            },
			getIsDirty: function() {
				var attributeManage = this.$$("rock-attribute-manage");
				if(attributeManage && attributeManage.getIsDirty) {
					return attributeManage.getIsDirty();
				}
			}
        });
    </script>
</dom-module>