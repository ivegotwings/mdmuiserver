<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../bedrock-component-context-behavior/bedrock-component-context-behavior.html">

<link rel="import" href="../rock-widget/rock-widget.html">

<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">

<!--
`rock-widget-panel` Represents an element that displays the `rock-widgets` 
based on the configuration that the user provided.

@demo demo/index.html
-->
<dom-module id="rock-widget-panel">
    <template>
        <style include="pebble-styles-shared">
            #widget-panel {
                padding: 10px;
                background: var(--palette-pale-grey-five, #f5f7f9);
                @apply(--rock-widget-panel);                
            }
        </style>
        <div id="widget-panel" class="row">
            <template is="dom-repeat" items="{{config.widgets}}" as="widget">
                <div class$="[[_computeLayout()]]">
                    <rock-widget id="[[widget.name]]" config="[[widget.config]]" context-data="[[contextData]]" icon-buttons="[[widget.iconButtons]]"
                        non-closable="[[widget.nonClosable]]" non-maximizable="[[widget.nonMaximizable]]" non-draggable="[[widget.nonDraggable]]">
                    </rock-widget>
                </div>
            </template>
        </div>
    </template>
</dom-module>
<script>
    (function () {
        'use strict';

        Polymer({
            is: 'rock-widget-panel',
            properties: {
                /*
                 * Indicates the configuration information that the user provided.
                 */
                config: {
                    type: Object,
                    value: function () {
                        return {};
                    },
                    notify: true
                },
          /**
            * <b><i>Content development is under progress... </b></i> 
            */
                contextData: {
                    type: Object,
                    value: function () {
                        return {};
                    }
                },
                /*
                 * Indicates the grid system for the element.
                 */
                noOfColumns: {
                    type: Number,
                    value: 2,
                    notify: true
                }
            },

            behaviors: [
                RUFBehaviors.ComponentContextBehavior
            ],

            _computeLayout: function () {
                if (this.noOfColumns == 1) {
                    return "colspan-1";
                }
                if (this.noOfColumns == 2) {
                    return "colspan-2";
                }
                if (this.noOfColumns == 3) {
                    return "colspan-3";
                }
                if (this.noOfColumns == 4) {
                    return "colspan-4";
                }
            },
          /**
            * <b><i>Content development is under progress... </b></i> 
            */
            reloadWidgets:function () {
                var widgets=Polymer.dom(this.root).querySelectorAll("rock-widget");
                for(var i in widgets){
                    widgets[i].refresh();
                }
            }
        });
    })();
</script>