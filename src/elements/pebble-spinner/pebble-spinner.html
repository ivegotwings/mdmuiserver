<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/paper-styles/color.html">
<link rel="import" href="pebble-spinner-styles.html">
<!--
Material design: [Progress & activity](https://www.google.com/design/spec/components/progress-activity.html)

Element providing a single color material design circular spinner.

    <pebble-spinner active></pebble-spinner>

The default spinner is blue. It can be customized to be a different color.

### Accessibility

Alt attribute should be set to provide adequate context for accessibility. If not provided,
it defaults to 'loading'.
Empty alt can be provided to mark the element as decorative if alternative content is provided
in another form (e.g. a text block following the spinner).

    <pebble-spinner alt="Loading contacts list" active></pebble-spinner>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--pebble-spinner-color` | Color of the spinner | `--google-blue-500`
`--pebble-spinner-stroke-width` | The width of the spinner stroke | 3px

@group Paper Elements
@element pebble-spinner
@hero hero.svg
@demo demo/index.html
-->
<dom-module id="pebble-spinner">
    <template strip-whitespace>
        <style include="pebble-spinner-styles"></style>
        <div id="spinnerContainer" class-name="[[__computeContainerClasses(active, __coolingDown)]]">
            <div class="spinner-layer">
                <div class="circle-clipper left"></div>
                <div class="circle-clipper right"></div>
                <!-- <img width="40" height="50" src="/src/images/Untitled2.gif"> -->
            </div> 
            
        </div>
    </template>
    <script>
        Polymer({
            is: 'pebble-spinner',

            listeners: {
                'animationend': '__reset',
                'webkitAnimationEnd': '__reset'
            },

            properties: {
                /**
                 * Displays the spinner.
                 */
                active: {
                    type: Boolean,
                    value: false,
                    reflectToAttribute: true,
                    observer: '__activeChanged'
                },

                /**
                 * Alternative text content for accessibility support.
                 * If alt is present, it will add an aria-label whose content matches alt when active.
                 * If alt is not present, it will default to 'loading' as the alt value.
                 */
                alt: {
                    type: String,
                    value: 'loading',
                    observer: '__altChanged'
                },

                __coolingDown: {
                    type: Boolean,
                    value: false
                }
            },

            __computeContainerClasses: function (active, coolingDown) {
                return [
                    active || coolingDown ? 'active' : '',
                    coolingDown ? 'cooldown' : ''
                ].join(' ');
            },

            __activeChanged: function (active, old) {
                this.__setAriaHidden(!active);
                this.__coolingDown = !active && old;
            },

            __altChanged: function (alt) {
                // user-provided `aria-label` takes precedence over prototype default
                if (alt === this.getPropertyInfo('alt').value) {
                    this.alt = this.getAttribute('aria-label') || alt;
                } else {
                    this.__setAriaHidden(alt === '');
                    this.setAttribute('aria-label', alt);
                }
            },

            __setAriaHidden: function (hidden) {
                var attr = 'aria-hidden';
                if (hidden) {
                    this.setAttribute(attr, 'true');
                } else {
                    this.removeAttribute(attr);
                }
            },

            __reset: function () {
                this.active = false;
                this.__coolingDown = false;
            }

        });
    </script>
</dom-module>