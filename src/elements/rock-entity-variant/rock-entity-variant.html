<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">
<link rel="import" href="../pebble-vertical-divider/pebble-vertical-divider.html">
<link rel="import" href="../pebble-tree/pebble-tree.html">
<link rel="import" href="../pebble-grid/pebble-grid.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">


<!--
`rock-entity-variant` Represents an element that is used to create new variants and entities.

@demo demo/index.html
-->
<dom-module id="rock-entity-variant">
    <template>
        <style include="pebble-styles-shared">


            .left {
                width:30%;
                /*display: inline-flex;*/
            }

            .right {
                width:70%;
                /*display: inline-flex;*/
            }

            .container {
                width:100%;
                display: inline-flex;
            }

        </style>
        <div class="container">
            <div class="left">
                <iron-ajax auto url="./demo/pebbleTreeData.json" handle-as="json" last-response="{{initialNav}}"></iron-ajax>
                <pebble-tree initial-nav="[[initialNav]]" selected-item="{{selectedItem}}" selected-items="{{selectedItems}}" multi-select enable-search></pebble-tree>
            </div>
            <pebble-vertical-divider></pebble-vertical-divider>
            <div class="right">
                <iron-ajax auto url="./demo/gridConfig.json" handle-as="json" last-response="{{gridConfig}}"></iron-ajax>
                <iron-ajax auto url="./demo/gridData.json" handle-as="json" last-response="{{gridData}}"></iron-ajax>
                <pebble-grid id = "pebbleGrid" config="{{gridConfig}}" page-size="10" data="{{gridData}}"></pebble-grid>
            </div>
        </div>
    </template>
    <script>
        (function() {
            'use strict';

            Polymer({

                is: 'rock-entity-variant',

                properties: {
                    /**
                     * Indicates the currently selected item.
                     */
                    selectedItem: {
                        type: String,
                        notify: true
                    },

                    /**
                     * Indicates the currently selected item list.
                     */
                    selectedItems: {
                        type: Array,
                        notify: true,
                        value: function() {return [];},
                        observer : 'selectedItemsChanged'
                    }
                },

                selectedItemsChanged : function() {
                    console.log('rerendering grid');
                    console.log(this.selectedItems);
                    this.$.pebbleGrid.reRenderGrid();
                }
            });
        })();
    </script>
</dom-module>