 <dom-module id="data-source">
 <template>
    <style include="pebble-styles-shared"></style>
</template>
<script>
    Polymer({
        is: 'data-source',

        properties: {
            dataSource: {
                notify: true,
                value: function() {
                return this._dataSource.bind(this);
                }
            },

            size: {
                notify: true,
                value: 0
            }
        },

        _dataSource: function(opts, cb) {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState == XMLHttpRequest.DONE) {
                    if (xhr.status == 200) {
                        
                        var json = JSON.parse(xhr.responseText);

                        if (this.size / opts.pageSize >= opts.page) {
                            this.size += this.size == 0 ? opts.pageSize * 2 : opts.pageSize;
                        }

                        // Simulating remote delay...
                        setTimeout(function() {
                        // just keeping the data flowing and returning a pageful of items
                        // on each call.
                            cb(json.slice(0, opts.pageSize));
                        }, 1000);
                    }
                }
            }.bind(this);

        // page parameters could be used like this:
        xhr.open("GET", 'gridData.json?per_page=' +
            opts.pageSize + '&page=' + opts.page, true);
        xhr.send();
        }
    });
</script>
</dom-module>