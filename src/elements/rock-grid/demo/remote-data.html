 <dom-module id="remote-data">
 <template>
    <style include="pebble-shared-styles"></style>
</template>
<script>
    Polymer({
        is: 'remote-data',

        properties: {
            dataSource: {
                notify: true,
                value: function() {
                return this._dataSource.bind(this);
                }
            },

            size: {
                notify: true,
                value: 0
            }
        },

        _dataSource: function(opts, cb) {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState == XMLHttpRequest.DONE) {
                    if (xhr.status == 200) {
                        debugger;
                        var json = JSON.parse(xhr.responseText);

                        // if last page is reached, increment the size.
                        // if (this.size / opts.pageSize >= opts.page) {
                        //     this.size += opts.pageSize;
                        // }

                        // if(opts.pageSize <= data.length)
                        // {
                            if (this.size / opts.pageSize >= opts.page) {
                                this.size += this.size == 0 ? opts.pageSize * 2 : opts.pageSize;
                            }
                        // }
                        // else
                        // {
                        //     if(this.size == 0) {
                        //         this.size = opts.pageSize;
                        //     }
                        //     else {
                        //         this.size -= opts.pageSize;                            
                        //     }
                        // }

                        // Simulating remote delay...
                        setTimeout(function() {
                        // just keeping the data flowing and returning a pageful of items
                        // on each call.
                            cb(json.slice(0, opts.pageSize));
                        }, 1000);
                    }
                }
            }.bind(this);

        // page parameters could be used like this:
        xhr.open("GET", 'gridData.json?per_page=' +
            opts.pageSize + '&page=' + opts.page, true);
        xhr.send();
        }
    });
</script>
</dom-module>