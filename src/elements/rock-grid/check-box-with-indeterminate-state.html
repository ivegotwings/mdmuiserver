<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">
<!--
    `check-box-with-indeterminate-state` Represents a component that renders a "checkbox" with an indeterminate state.
    It is used in conjunction with the `rock-grid` component.
    @demo demo/index.html
-->
<dom-module id="check-box-with-indeterminate-state">
    <template>
        <style include="pebble-styles-shared">
             :host {
                height: var(--paper-checkbox-size, var(--default-checkbox-size));
                width: var(--paper-checkbox-size, var(--default-checkbox-size));
                /*flex-basis: 48px;*/
                /*flex-grow: 0;*/
                /*flex-shrink: 0;*/
                /*padding: 0 8px 0 12px;*/
                display: flex;
                display: -webkit-flex;
                /* Safari */
                align-items: center;
                -webkit-align-items: center;
                /* Safari 7.0+ */
                justify-content: center;
                -webkit-justify-content: center;
                /*border-right: 1px solid #e3e3e3;*/
            }

             :host([header]) {
                height: auto;
            }

             :host([hidden]) {
                display: none;
            }

             :host(:focus) {
                outline: none;
            }

             :host {
                border-right: none;
            }

            @-webkit-keyframes checkmark-expand {
                0% {
                    -webkit-transform: scale(0, 0) rotate(45deg);
                }
                100% {
                    -webkit-transform: scale(1, 1) rotate(45deg);
                }
            }

            @keyframes checkmark-expand {
                0% {
                    transform: scale(0, 0) rotate(45deg);
                }
                100% {
                    transform: scale(1, 1) rotate(45deg);
                }
            }

            #container {
                position: relative;
                box-sizing: border-box;
                border-radius: var(--default-border-radius);
                height: var(--paper-checkbox-size, var(--default-checkbox-size));
                width: var(--paper-checkbox-size, var(--default-checkbox-size));
                border: 1px solid var(--paper-checkbox-unchecked-color, var(--palette-cloudy-blue));
                pointer-events: none;
                -webkit-transition: background-color 140ms, border-color 140ms;
                transition: background-color 140ms, border-color 140ms;
            }

             :host::shadow #container,
            paper-checkbox::shadow #checkbox {
                border: solid 1px;
                border-color: var(--paper-checkbox-unchecked-color, var(--palette-cloudy-blue));
                border-radius: var(--default-border-radius);
                height: var(--paper-checkbox-size, var(--default-checkbox-size));
                width: var(--paper-checkbox-size, var(--default-checkbox-size));
            }

             :host([header]) :host::shadow #container {
                border-color: var(--paper-checkbox-unchecked-color, var(--palette-cerulean));
            }

             :host([header]) :host([indeterminate])::shadow .checkmark {
                border-color: var(--paper-checkbox-indeterminate-color, var(--palette-cerulean));
            }

             :host([checked])::shadow #container,
            paper-checkbox[checked]::shadow #checkbox {
                background-color: var(--paper-checkbox-checked-color, var(--palette-cerulean-two));
                border-color: var(--paper-checkbox-checked-color, var(--palette-white));
            }

             :host([checked])::shadow .checkmark {
                border-bottom: 2px solid white;
                border-right: 2px solid white;
                width: 36%;
                height: 70%;
                -webkit-transform-origin: 60% 110%;
                transform-origin: 60% 110%;
                -webkit-animation: checkmark-expand 140ms ease-out forwards;
                animation: checkmark-expand 140ms ease-out forwards;
            }
            


             :host([indeterminate]) .checkmark {
                border-bottom: 2px solid var(--primary-text-color);
                width: 60%;
                margin-top: 5px;
                margin-left: 3px;
                -webkit-animation: indeterminate-expand 140ms ease-out forwards;
                animation: indeterminate-expand 140ms ease-out forwards;
                border-color: var(--paper-checkbox-indeterminate-color, var(--palette-cerulean));
            }

            @-webkit-keyframes indeterminate-expand {
                0% {
                    -webkit-transform: scale(0, 0);
                }
                100% {
                    -webkit-transform: scale(1, 1);
                }
            }

            @keyframes indeterminate-expand {
                0% {
                    transform: scale(0, 1);
                }
                100% {
                    transform: scale(1, 1);
                }
            }
        </style>

        <div id="container">
            <div class="checkmark"></div>
        </div>

    </template>
    <script>
        Polymer({
            is: 'check-box-with-indeterminate-state',
            properties: {

                /**
                 * Specifies whether or not the checkbox is in the checked state. If it is set to <b>true</b> 
                 * then the checkbox is in checked state.
                 */
                checked: {
                    type: Boolean,
                    observer: '_checkedChanged',
                    reflectToAttribute: true,
                    value: false
                },

                /**
                 * Specifies whether or not the checkbox is in indeterminate state. If it is set to <b>true</b> 
                 * then the checkbox is in indeterminate state.
                 */
                indeterminate: {
                    type: Boolean,
                    reflectToAttribute: true,
                    observer: '_indeterminateChanged',
                    value: false
                }
            },

            /**
             * Internal function, triggered if checked state is changed
             */
            _checkedChanged: function (checked) {
                if (checked) {
                    this.indeterminate = false;
                }
            },

            /**
            * Internal function, triggered if indeterminate state is changed
            */
            _indeterminateChanged: function (indeterminate) {
                if (indeterminate) {
                    this.checked = false;
                }
            }
        });
    </script>
</dom-module>