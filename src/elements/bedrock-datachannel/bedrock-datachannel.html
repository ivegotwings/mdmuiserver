<link rel="import" href="../bedrock-externalref-falcor/bedrock-externalref-falcor.html">-->

<script>
/*
* @demo demo/index.html
* @polymerBehavior RUFBehaviors.DataChannel
*/
   var RUFBehaviors = RUFBehaviors || {};

   RUFBehaviors.DataChannel = {
      
      properties: {
        /**
          * Indicates key for the translation.If it is set to <b>true</b>, then it uses provided key when
          * the translation does not exist for that key.
          */
         model: {
            type: Object,
            value: undefined
         },
         callCounters:{
           type: Object,
           value: function() {
             return {};
           }
         }
      },
      getCallCounters: function(){
        return this.callCounters;
      },
      updateCallCounters: function(operation){

        if(this.callCounters === undefined){
          this.callCounters = {}
        };

        console.log(this.callCounters);

        if(this.callCounters[operation] !== undefined){
          this.callCounters[operation] = this.callCounters[operation] + 1
        }
        else{
          this.callCounters[operation] = 1;
        }
      },
      getModel: function(){
        if(this.model === undefined){
          this.model = this._createModel();
        }
        
        return this.model;
      },
      _createModel: function(){
        var falcorDataSource = new falcor.HttpDataSource('/entityData.json', { crossDomain: true, withCredentials: false } );
        var model = new falcor.Model({
            source: falcorDataSource, 
            maxSize: 15000, 
            collectRatio: 0.75//,
            // errorSelector: function(error){
            //     error.$expires = -1000 * 60 * 2;
            // } 
          });
        
        model.treatErrorsAsValues();
        return model;
      }
   };
   
</script>