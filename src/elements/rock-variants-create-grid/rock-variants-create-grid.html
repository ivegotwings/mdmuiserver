<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../bedrock-helpers/data-helper.html">
<link rel="import" href="../bedrock-pubsub/bedrock-pubsub.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">

<link rel="import" href="../liquid-entity-get/liquid-entity-get.html">
<link rel="import" href="../liquid-entity-data-get/liquid-entity-data-get.html">

<link rel="import" href="../rock-grid/rock-grid.html">
<link rel="import" href="../rock-grid/remote-data.html">

<!--
` rock-variants-create-grid` component is used to render all possible variants in grid based on the options selected.

@demo demo/index.html
-->

<dom-module id="rock-variants-create-grid">
    <template>
        <style include="pebble-styles-shared"></style>
        <p>You select <b>2 Colors</b> and <b>2 Sizes</b> as possible options. We have created <b>4</b> potential SKU options for you.
            All new SKUs in th list below will be created unless you want to delete the SKUs from this list.
        </p>
        <iron-ajax auto url="/src/data/EntityManageApp/createVariantsGridConfig.json" handle-as="json" last-response="{{gridConfig}}"></iron-ajax>
        <liquid-entity-get auto name="attributeModelGetService" request="{{attributeModelRequest}}" response="{{attributeModelResponse}}"></liquid-entity-get>
        <rock-grid  title="Variant Options" id="variantGrid" data="{{data}}"  config="{{gridConfig}}" attribute-models="{{attributeModelResponse.returnValue.attributeModels}}" page-size="4"></rock-grid>
        <div id="content-actions" align="center">
            <pebble-button class="action-button btn btn-secondary" id="skip" button-text="Cancel" raised on-tap="_onCancelTap"></pebble-button>
            <pebble-button class="action-button-focus dropdownText btn btn-success m-r-5" id="next" button-text="Save" raised on-tap="_onSaveTap"></pebble-button>
        </div>
    </template>

    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'rock-variants-create-grid',
                properties: {
                    /**
                    * Indicates the identification of the entity for which the variants are shown.
                    */
                    entityId: {
                        type: String
                    },
                    /**
                     * Indicates the locale dimension for which the attributes are managed.
                     */
                    locale: {
                        type: String
                    },
                    /**
                     * Indictaes the list for which the attributes are managed.
                     */
                    list: {
                        type: String
                    },
                    /**
                     * Indictaes the classification for which the attributes are managed.
                     */
                    classification: {
                        type: String,
                        value: "nivea/niveaBodyCare/niveaBody/nbodyEssential/nbody/ess/nourishingMilkDry"
                    },
                    /**
                     * Indictaes the source dimension for which the attributes are managed.
                     */
                    source: {
                        type: String
                    },
                    /**
                     * Indicates the request object that is passed to the data element to retrive attribute model data.
                     Sample: { 
                            action: "getAttributeModels" 
                        }
                     */
                    attributeModelRequest: {
                        type: Object,
                        value: function () {
                            return {
                                action: "getAttributeModels"
                            };
                        }
                    },
                    /**
                     * Specifies the configuration object that to be passed to grid.
                     */
                    gridConfig: {
                        type: Object,
                        value: function() {
                            return {};
                        }
                    },
                    _attributeModelRequest: {
                        type: Object,
                        value: function () {
                            return {
                                action: "getAttributeModels"
                            }
                        }
                    },
                    selectedItems:{

                    }

                },

                observers: [

                ],

                behaviors: [
                    RUFBehaviors.UIBehavior
                ],
                _onCancelTap: function(e) {
                    //raise event with name given for onbackAction in configuration
                    var eventName = "onCancel";
                    var eventDetail = {
                        name: eventName
                    };
                    this.fireBedrockEvent(eventName, eventDetail,{ ignoreId: true });
                },
                _onSaveTap: function(e) {
                    var eventName = "onComplete";
                    var eventDetail = {
                        name: eventName,
                        data:this.selectedOptions
                    };
                    this.fireBedrockEvent(eventName, eventDetail,{ ignoreId: true });
                }
            });
        })();
    </script>
</dom-module>