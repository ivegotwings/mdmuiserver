<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../../bower_components/shadycss/apply-shim.html">
<link rel="import" href="../../../bower_components/polymer/lib/elements/custom-style.html">

<link rel="import" href="../pebble-styles-app/pebble-styles-app.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">

<link rel="import" href="../pebble-popover/pebble-popover.html">
<link rel="import" href="../pebble-button/pebble-button.html">

<!--
    @group rock Elements
    @element pebble-info-icon
-->
<dom-module id="pebble-info-icon">
    <template>
        <style>
            :root {
                --rock-attrubute-description-icon-color: #BECAD4;
            }

            pebble-popover {
                font-weight: normal;
                text-transform: initial;
                --default-popup-b-p: 5px;
                --default-popup-t-p: 5px;
                --default-font-size: 12px;
                --pebble-popover-text-color: var(--default-text-color);
            }

            .description-image-wrapper {
                cursor: pointer;
                display: inline-block;
            }

            .attributes-description {
                padding-left: 5px;
                padding-right: 5px;
            }

            .description-list {
                margin: 0;
                padding: 0;
            }

            .description-item {
                list-style: none;
            }

        </style>
        <template is="dom-if" if="[[_items.length]]">
            <div class="description-image-wrapper"
                 id="show-description-icon"
                 on-click="_showDescription">
                <img src$="../../../src/images/[[icon]]" height="16px" width="16px" />
            </div>
            <pebble-popover id="description-popover" for="show-description-icon">
                <div class="attributes-description">
                    <ul class="description-list">
                        <template is="dom-repeat" items="{{_items}}" as="item">
                            <li class="description-item">{{item}}</li>
                        </template>
                    </ul>
                </div>
            </pebble-popover>
        </template>
    </template>

    <script>
        Polymer({
            is: 'pebble-info-icon',

            properties: {
                attributeProperties: {
                    type: Object,
                    notify: true,
                    value: function () {
                        return {};
                    },
                    observer: "_attributePropertiesChanged"
                },
                _items: {
                    type: Array,
                    value: function () {
                        return [];
                    }
                },
                icon: {
                    type: String,
                    value: "info.svg"
                }
            },

            _attributePropertiesChanged: function (newValue, oldValue) {
                if (newValue && newValue.description) {
                    if(newValue.description instanceof Array){
                        this._items = newValue.description;
                    } else {
                        this._items = [newValue.description];
                    }
                }
            },

            _showDescription: function (e) {
                var description = Polymer.dom(this.root).querySelector('#description-popover');
                if (description) {
                    description.show();
                }
                e.stopPropagation();
            }
        });

    </script>
</dom-module>
