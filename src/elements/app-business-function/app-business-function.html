<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../bedrock-pubsub/bedrock-pubsub.html">

<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">
<link rel="import" href="../pebble-actions/pebble-actions.html">

<link rel="import" href="../rock-layout/rock-layout.html">
<link rel="import" href="../rock-layout/rock-titlebar/rock-titlebar.html">
<link rel="import" href="../rock-wizard/rock-wizard.html">

<dom-module id="app-business-function">
  <template>
    <style include="pebble-styles-shared"></style>
     <rock-layout>
      <rock-titlebar icon="pebble-md-icons:UserIcon" title="[[config.label]]"></rock-titlebar>
      <iron-ajax auto url="/src/data/business-function-entity-create.json" handle-as="json" on-response="_handleResponse"></iron-ajax>
      <rock-wizard config="{{config}}"></rock-wizard>
    </rock-layout>                 
  </template>
  <script>
    (function() {
      'use strict';

        Polymer({
            is: 'app-business-function',
            properties: {
              name: {
                type: String
              },
              config: {
                type: Object,
                value: function() { return {}; }
              },
              context: {
                type: Object,
                value: function() { return {}; }
              },
              properties: {
                type: Object,
                value: function() { return {}; }
              }
            },
            behaviors: [
                RUFBehaviors.UIBehavior
            ],
             _handleResponse: function(e) {
                this._setConfigData(e.currentTarget.lastResponse);
            },
            _setConfigData: function(config) {
                //can alter the cofnig before setting it to wizard
                this.set("config", config);
            },
            getIsDirty: function() {
              return this.$$('rock-wizard').getIsDirty();
            }
      });
    })();
  </script>
</dom-module>