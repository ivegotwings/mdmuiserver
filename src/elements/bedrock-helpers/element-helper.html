<!--
`element-helper` Represents a bunch of helpers to work with html elements that any bedrock, pebble, rock or app can use.
-->
<!--<link rel="import" href="../../../bower_components/polymer/polymer.html">-->
<script>
    window.ElementHelper = window.ElementHelper || {};

    (function () {
        ElementHelper.cloneObject = function (o) {
            return DataHelper.cloneObject(o);
        };

        ElementHelper.getShadowElement = function (customElement) {
            var rootElement;

            if (window.Polymer.Settings.dom == "shadow") {
                rootElement = customElement.root;
            } else {
                rootElement = customElement;
            }

            return rootElement;
        };

        /**
         * Get the element from the current document
         */
        ElementHelper.getElement = function (currentNode, selector) {
            if (selector && currentNode && currentNode.shadowRoot) {
                return currentNode.shadowRoot.querySelector(selector) ||
                    Polymer.dom(currentNode).node.querySelector(selector);
            }
        };

        var ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';

        var UNIQUE_RETRIES = 9999;

        var ids = [];

        var generate = function(ID_LENGTH){
            var rtn = '';
            for (var i = 0; i < ID_LENGTH; i++) {
                rtn += ALPHABET.charAt(Math.floor(Math.random() * ALPHABET.length));
            }
            return rtn;
        }

        var generateUnique = function(length, previous) {
            previous = previous || [];
            var retries = 0;
            var id;

            // Try to generate a unique ID,
            // i.e. one that isn't in the previous.
            while(!id && retries < UNIQUE_RETRIES) {
                id = generate(length);
                if(previous.indexOf(id) !== -1) {
                    id = null;
                    retries++;
                }
            }

            return id;
        };

        ElementHelper.getRandomId = function () {
            return generateUnique(16, ids);
        };

        ElementHelper.getRandomString = function () {
            return generateUnique(12, ids);
        };

        ElementHelper.noBubble = function (e) {
            e = e || event;
            if (e) {
                e.returnValue = false;
                e.cancelBubble = true;
                e.stopPropagation();
                e.preventDefault();
            }
        };
        
        ElementHelper.fireClick = function (node) {
            if (document.createEvent) {
                var evt = document.createEvent('MouseEvents');
                evt.initEvent('click', true, false);
                node.dispatchEvent(evt);
            } else if (document.createEventObject) {
                node.fireEvent('onclick');
            } else if (typeof node.onclick == 'function') {
                node.onclick();
            }
        };

        ElementHelper.getElementPath = function (e) {
            var path = e.path || (e.composedPath && e.composedPath());
            if (path) {
                return path;
            }
            else {
                path = [];
                var node = e.target;
                while (node) {
                    var pathNode = node;
                    path.push(pathNode);
                    node = node.parentNode;
                }
            }
            return path;
        };
    })();

</script>