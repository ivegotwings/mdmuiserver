<link rel="import" href="../../../bower_components/polymer/polymer.html">

<!--
`liquid-entity-getdata`
Boolean control

@demo demo/index.html 
-->

<dom-module id="liquid-entity-getdata">
  <template>
    <label>Request: [[request]]</label>
    <br>
    <label>Response: [[response]]</label>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'liquid-entity-getdata',
        attached: function() {
          console.log("service attached");
          this.response = this._makeServiceCall(this.request);
        },
        properties: {
          request: {
            type: Object,
            value: function() {
              return {};
            }
          },
          response: {
            type: Object,
            value: function() {
              return {};
            },
            notify: true
          }
        },
        _makeServiceCall: function(request) {
          //make service call and return the response
          //console.log("_makeServiceCall");
          if(request)
          {
            var falcorDataSource = new falcor.HttpDataSource('http://localhost:5005/model.json', { crossDomain: true, withCredentials: false } );
            var model = new falcor.Model({source: falcorDataSource});
            var _this = this;
            var entityData;
            model.get(["entitiesById", ["e1"]]).then(function(responseX) {
                    console.log(responseX.json);
                    entityData = JSON.parse(responseX.json.entitiesById.e1);
                    console.log(entityData);
                    return entityData;
                  });
          }
        }
      });
    })();
  </script>
</dom-module>