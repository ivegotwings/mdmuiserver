<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../liquid-entity-getdata.html">

<dom-module id="liquid-entity-getdata-workflow-definition-demo">
    <template>
        <liquid-entity-getdata id="entityGetData1" auto$="[[auto]]" verbose operation="getentities" request-id="req1" request-data={{request}} 
        last-response={{entities}} on-response="_onEntitiesReceived" on-error="_onEntityGetFailed"></liquid-entity-getdata>
    </template>
    <script>
        (function () {
            'use strict';
            Polymer({
                is: 'liquid-entity-getdata-workflow-definition-demo',
                attached: function(){
                    console.log('workflow-definition-demo attached');
                },
                properties: {
                    auto: {
                        type: Boolean,
                        value: false
                    },
                    request: {
                        type: Object,
                        value: function () {
                            return {
                                "params": {
                                    "query": {
                                        "ctx": [
                                            {
                                                "list": "workflowDefinitions"
                                            }
                                        ],
                                        "valCtx": [
                                            {
                                                "source": "self",
                                                "locale": "en-US"
                                            }
                                        ],
                                        "id": "productEnrichmentWorkflow_id",
                                        "filters": {
                                            "attributesCriterion": [],
                                            "typesCriterion": [
                                                "workflowDefinition"
                                            ]
                                        }
                                    },
                                    "fields": {
                                        "ctxTypes": [
                                            "properties"
                                        ],
                                        "attributes": [
                                            "workflowName",
                                            "workflowVersion",
                                            "published",
                                            "activities"
                                        ],
                                        "relationships": [
                                            "ALL"
                                        ]
                                    }
                                }
                            };
                        },
                        notify: true
                    }
                },
                generateRequest: function() {
                    this.$$('#entityGetData1').generateRequest();
                },
               _onEntitiesReceived: function (e) {
                    console.log('entities received ', JSON.stringify(e.detail.response, null, 4));
                },
                _onEntityGetFailed: function (e) {
                    Polymer.Base._error('entities get failed with error ', e.detail);
                }
            });
        })();
    </script>
</dom-module>