<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/shadycss/apply-shim.html">
<link rel="import" href="../../../bower_components/paper-button-group/paper-button-group.html">
<link rel="import" href="../../../bower_components/polymer/lib/elements/custom-style.html">

<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../bedrock-validator/bedrock-validator.html">
<link rel="import" href="../bedrock-style-manager/styles/bedrock-style-common.html">

<link rel="import" href="../pebble-info-icon/pebble-info-icon.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">


<!--
`pebble-boolean` Represents an element which displays and controls the boolean value. 
 They can contain values as true or false.  

### Styling

Custom property    | Description              | Default
-------------------|-------------|----------------------
`--pebble-boolean` | Mixin applied to pebble-boolean | `{}`
`--active-button-font-color` | Active button font color | #ffffff
`--pebble-boolean-true-bg-color` | Active true button background color | #4caf50
`--pebble-boolean-false-bg-color` | Active false button background color | #f44336
`--false-button-margin` | Margin for false button | `0 0 0 -5px`
`--boolean-btn-radius` | Boolean button radius | 4px
`--pebble-boolean-label` | Mixin applied to pebble-boolean label | {}

@group pebble Elements
@element pebble-boolean
@demo demo/index.html 
-->

<dom-module id="pebble-boolean">
  <template>
    <custom-style>
      <style include="bedrock-style-common">
          paper-button {
            padding: 0;
            border: 1px solid var(--default-border-color, #c1cad4);
            color: var(--default-icon-color, #8994a0);
            border-radius: 0px;
            height: 20px;
            min-width: 40px;
            float: left;
            @apply --pebble-boolean;    
            font-size: var(--font-size-xs, 10px);  
          }

          paper-button-group {
            display: inline-block;
          }

          paper-button[name=true][active] {
              color: var(--button-text-color, #ffffff);
              background-color: var(--success-button-color, #09c021);
              border: 1px solid var(--success-button-color, #09c021);
          }

          paper-button[name=false][active] {
              color: var(--button-text-color, #ffffff);
              background-color: var(--default-border-color, #c1cad4);
          }

          paper-button[name=false] {
            margin: var(--false-button-margin, 0 0 0 -1px);
            border-top-right-radius: var(--boolean-btn-radius, 4px);
            border-bottom-right-radius: var(--boolean-btn-radius, 4px);
          }

          paper-button[name=true] {      
            margin: 0;
            border-top-left-radius: var(--boolean-btn-radius, 4px);
            border-bottom-left-radius: var(--boolean-btn-radius, 4px);
            background-color: var(--palette-white, #ffffff);
          }

          #lblBoolean {
              color: var(--label-text-color, #96b0c6);
              font-size: var(--font-size-sm, 12px);
              line-height: 10px;
              margin-bottom: 5px;
              @apply --pebble-boolean-label;
              text-transform: none;
          }

          .error  {
            color: var(--error-color, #ed204c);
            font-size: var(--font-size-sm, 12px);
            font-weight: var(--font-regular, 400);
            letter-spacing: 0.011em;
            line-height: 20px;
            width: 92%;
            word-wrap: break-word;
          }
      </style>
    </custom-style>
    <div id="booleanContainer" class="clearfix">
      <div id="lblBoolean" class="attribute-view-label">
          [[label]]
          <template is="dom-if" if="[[descriptionObject]]">
            <pebble-info-icon description-object="[[descriptionObject]]"></pebble-info-icon>
          </template>
      </div>
      <paper-button-group aria-labelledby="lblBoolean" attr-for-selected="name" selected="{{_computedValue}}" tabindex="-1">
          <paper-button name="true" noink>[[_isNullOrEmpty(trueText, 'TRUE')]]</paper-button>
          <paper-button name="false" noink>[[_isNullOrEmpty(falseText, 'FALSE')]]</paper-button>              
      </paper-button-group>      
        <bedrock-validator show-error="[[showError]]" validation-errors="{{validationErrors}}" input="[[value]]"  required="[[required]]"
                           invalid="{{invalid}}" error-message="{{errorMessage}}" type="[[validationType]]"
        ></bedrock-validator>
        <div class="error" ><span> {{errorMessage}}</span></div>
    </div>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'pebble-boolean',
        ready: function(){
        },
        properties: {
         
          /**
           * Indicates the title of the boolean control that is displayed on the UI.
           */
          label: {
            type: String,
            value: ""
          },
          
          /**
           * Indicates the current value selected for the boolean.
           * By default, it notifies the current value chosen.
           */
          value: {
            type: String,
            value: "",
            notify: true,
            observer: '_valueChanged'
          },

           /**
           * Indicates the computed value which is bound to the `button` group.
           * By default, it notifies the current value chosen.
           */
          _computedValue: {
            type: String,
            value: "",
            observer: '_computedValueChanged'
          },

          /**
           * Indicates the true button text.
           */
          trueText: {
            type: String,
            value: "TRUE"
          },

          /**
           * Indicates the false button text.
           */
          falseText: {
            type: String,
            value: "FALSE"
          },
          /**
           * Indicates whether to mark the input as required or not.
           * Set the value as <b>true</b> to mark the input as required.
           */
          required:{
              type:Boolean,
              value:false
          },
          /**
           * Indicates whether to show the validation errors or not.
           * Set the value as <b>true</b> to show the validation errors.
           */
          showError:{
              type:Boolean,
              value:false
          },
          /**
           * Description object should contain non-empty
           * description field (type type: Array or String)
           */
          descriptionObject: {
              type: Object,
              notify: true,
              value: function () {
                  return {};
              }
          }
        },
        behaviors: [
            RUFBehaviors.UIBehavior
        ],
        _valueChanged: function() {
          if(this.value != this._computedValue) {
            this._computedValue = this._computeValue(this.value);
          }
        },
        _computedValueChanged: function() {
          if(this._computeValue(this.value) != this._computedValue) {
            this.value = this._computedValue;
          }
        },
        _computeValue: function(value) {
          //only three valid values, otherwise ''
          if(value == 'true' || value == 'false' || value == '') {
            return value;
          } else {
            return '';
          }
        }
      });
    })();
  </script>

</dom-module>