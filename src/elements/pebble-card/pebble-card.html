<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/paper-styles/default-theme.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/iron-icons/communication-icons.html">
<link rel="import" href="../../../bower_components/iron-icons/hardware-icons.html">
<link rel="import" href="../../../bower_components/iron-icons/social-icons.html">
<link rel="import" href="../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../../../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">

<link rel="import" href="../pebble-styles-app/pebble-styles-app.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../bedrock-helpers/element-helper.html">
<!--
` <pebble-card> ` Represents a container with a drop shadow. 
It can contain a photo, text, and a link about a single subject. 
It can display content containing elements of varying size such as notification list or charts.

@demo demo/index.html 
-->

<dom-module id="pebble-card">
    <template>
       <style is="custom-style" include="pebble-styles-app"></style>
        <style>
			:host {
				display: flex;
    		    flex-direction: column;
			}
			/* IE 10 support for HTML5 hidden attr */
			
			[hidden] {
				display: none !important;
			}
			.widget-title iron-icon {
				margin-right: 10px;
                @apply(--layout-start);
                width: 20px;
                height: 20px;
			}
            			
			.header .title-text.over-image {
				position: absolute;
				bottom: 0px;
				@apply(--paper-card-header-image-text);
			}
			
			:host::content .card-content {
				padding: 0; /* 16px */
				position: relative;
				@apply(--paper-card-content);
			}
			
			:host::content .card-actions {
				border-top: 1px solid #e8e8e8;
                padding: 0px;
				position: relative;
				@apply(--paper-card-actions);
			}	
            paper-menu-button{
                padding: 0;
            } 
			
			:host paper-icon-button {
				color: var(--paper-grey-600);
				width: 14px;
				height: 14px;
				padding: 0px;
                margin-right:8px;
			}
            .card-icons{
                font-size: 0;
            }
			
			:host paper-icon-button.white {
				color: var(--palette-white,#fff) !important;
			}
			
			:host paper-item {
				cursor: pointer;
			}
            ::shadow pebble-tab-group{
                margin-bottom: 20px;
            }
            .pebble-md-icons::shadow paper-button {
				color: var(--primary-icon-color, #75808b);
            }
		</style>
<div class="widget-box">
    <div class="p-0 row">
        <div hidden$="[[!heading]]" class="widget-title">
            <iron-icon class="big layout-start" icon="[[headerIcon]]"></iron-icon> [[heading]]
        </div>
        <div class="card-icons">
            <template is="dom-if" if="[[!nonMaximizable]]">
                <paper-icon-button name="maximize" icon="pebble-md-icons:Expand" title="Maximize" on-tap="_onMaximizeClick"></paper-icon-button>
                <pebble-button id="settings" class="minimize pebble-md-icons" name="settings" icon="pebble-md-icons:Settings" title="Settings">
            </pebble-button>
            
            </template>
            <template is="dom-if" if="[[!nonClosable]]">
                <paper-icon-button name="remove" icon="pebble-icons:Clear" title="Remove" on-tap="_onRemoveClick"></paper-icon-button>
            </template>
            
            <template is="dom-if" if="[[iconButtons]]">
                <paper-menu-button>
                    <paper-icon-button class="dropdown-trigger pebble-md-icons" name="more" icon="pebble-md-icons:MoreVert" title="More options"></paper-icon-button>
                    <paper-menu class="dropdown-content">
                        <template is="dom-repeat" items="[[iconButtons]]">
                            <paper-item name="[[item.name]]" on-tap="_onIconButtonClick">[[item.label]]</paper-item>
                        </template>
                    </paper-menu>
                </paper-menu-button>
            </template>
        </div>
    </div>

    <content></content>
</div>
</template>

<script>
    (function () {
        'use strict';

        Polymer({
            is: 'pebble-card',
            ready: function () {
            },
            properties: {
                /**
       * Indicates the title of the card.
       * 
                 */
                heading: {
                    type: String,
                    value: "Card Heading"
                },
                /**
       * Indicates the url of the title image of the card.
       * 
                 */
                headerIcon: {
                    type: String,
                    value: "pebble-icons:Dashboard"
                },
                /**
       * Specifies whether the card container can be closed or not.
                 * If it is set to <b>true</b>, then the card container cannot be closed.
       * 
                 */
                nonClosable: {
                    type: Boolean,
                    value: false
                },
                /**
       * Specifies whether the card container can be maximized or not.
                 * If it is set to <b>true</b>, then the card container cannot be maximized.
       * 
               */
                nonMaximizable: {
                    type: Boolean,
                    value: false
                },
                /**
      * Specifies whether the card container's position can be dragged or not.
                * If it is set to <b>true</b>, then the card is not draggable.
      * 
                */
                nonDraggable: {
                    type: Boolean,
                    value: false
                },
                /**
      * Indicates the list of actions available in <b>more</b> icon on top right corner of the card.
      * 
                */
                iconButtons: {
                    type: Array,
                    value: function () { return null; }
                }
            },
            /**
      * Used to process the event that gets tiggered when one of the header buttons gets clicked. 
      * 
                */
            _onIconButtonClick: function (e) {
                var targetName = e.target.name;
                //when clicking on the atcual icon, the target is iron icon, 
                //when clicking outside edge of icon the target is paper icon button
                var path = ElementHelper.getElementPath(e);
                if (e.target.tagName == "IRON-ICON") {
                    targetName = path[1].name;
                }
                for (var i = 0; i < this.iconButtons.length; i++) {
                    if (this.iconButtons[i].name == targetName) {
                        eval(this.iconButtons[i].click);
                    }
                }
            },
            /**
      * Used to process the event that gets tiggered when "Maximize" button is clicked. 
      * 
                */
            _onMaximizeClick: function (e) {
                alert('_onMaximizeClick');
            },
            /**
      * Used to process the event that gets tiggered when "Remove" button is clicked. 
      * 
                */
            _onRemoveClick: function (e) {
                alert('_onRemoveClick');
            }
        });
    })();
</script>

</dom-module>