<!doctype html>

<html>

<head>
  <title>rock-entity-header test</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <script src="../../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../../../bower_components/web-component-tester/browser.js"></script>

  <link rel="import" href="../rock-entity-header.html">
</head>

<body>

  <test-fixture id="basic">
    <template>
      <rock-entity-header></rock-entity-header>
    </template>
  </test-fixture>
  <script>
      var attributeData = [{"attributeName": "salesPrice", "label":"sales price"},
                            {"attributeName": "vendorCost", "label":"vendor cost"}];
      var profileData = {"completionPercentage": 65,
                         "warnings": [{"message": "Brand Extension not available"}]};
      var rockElement;
      setup(function() {
          rockElement = fixture('basic');
          rockElement.headerAttributeRequest = attributeData;
          rockElement.data = profileData;
      });
      suite('rock-entity-header', function() {
        
        test('instantiating the element works', function() {
          assert.equal(rockElement.is, 'rock-entity-header');
        });

        test('Should show profile completion percentage on button', function() {                   
          assert.equal(rockElement.$.pebbleButton.attributes['button-text'].value, '65%');
        });

        test('popover with invalid & missing attributes of entity should open on click of profile percentage button', function() {
          rockElement.$.pebbleButton.click();
          assert.equal(rockElement.$.tofixPopover.opened, true);
        });

        test('attribute label is displayed when longName is not available for attribute', function() {            
            var attrLabel = rockElement._getAttributeLabel(rockElement.headerAttributeModelResponse, attributeData[0]);
            assert.equal(attrLabel, "sales price");
        });

        test('longName of attribute should be displayed if longName is present in attribute model', function() {
            var attrLabel = rockElement._getAttributeLabel(rockElement.headerAttributeModelResponse, attributeData[1]);
            assert.equal(attrLabel, "Vendor Cost");
        })
     });
     
    </script>
</body>

</html>