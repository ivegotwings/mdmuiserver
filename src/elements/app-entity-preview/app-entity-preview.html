<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../bedrock-app-behavior/bedrock-app-behavior.html">
<link rel="import" href="../rock-layout/rock-layout.html">
<link rel="import" href="../rock-layout/rock-titlebar/rock-titlebar.html">
<link rel="import" href="../pebble-templatizer/pebble-templatizer.html">
<link rel="import" href="../rock-entity-preview/rock-entity-preview.html">

<dom-module id="app-entity-preview">
    <template>
        <style>
            rock-layout {
                --rock-footer-background-color: #f5f7f9;
            }
        </style>
        <rock-layout>
            <rock-entity-preview context-data="[[contextData]]" entity-type="[[entityType]]" entity-id="[[entityId]]" template-id="[[templateId]]"></rock-entity-preview>
        </rock-layout>
        <bedrock-pubsub on-bedrock-event-initializeshell="_initializeshell" name="bedrock-event-initializeshell"></bedrock-pubsub>
    </template>
    <script>
        (function () {
            'use strict';
            Polymer({
                is: 'app-entity-preview',
                created: function () {},
                properties: {
                    appConfig: {
                        type: Object,
                        value: function () {
                            return {};
                        }
                    },
                    dataModel: {
                        type: Object,
                        value: function () {
                            return {};
                        }
                    },
                    rendercms: {
                        type: Boolean,
                        value: false
                    }
                },
                behaviors: [
                    RUFBehaviors.AppBehavior
                ],
                ready: function () {
                    let state = DataHelper.getStateFromQueryParams();
                    this.contextData = state.contextData;
                    this.entityType = state._entityType;
                    this.entityId = state._entityId;
                    this.templateId = state.templateId;
                },
                _onComponentCreating: function (e, detail, sender) {
                    var component = detail.data;
                    component.properties["context-data"] = this.contextData;
                },
                _initializeshell: function () {
                    RUFUtilities.appCommon.showHeaderSideBar = false;
                    RUFUtilities.appDrawer.hidden = true;
                    RUFUtilities.progressBar.hidden = true;
                    RUFUtilities.navbarPlaceholder.hidden = true;
                    RUFUtilities.middleContainer.style['margin-left'] = 0;
                }
            });
        })();
    </script>
</dom-module>