<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bedrock-validator/bedrock-validator.html">

<!--
`pebble-textbox` Represents a single-line text field with proper styling.
  It allows to input text, select text, and lookup data via auto-completion.
  Text fields usually appear in forms. Text, numbers, or mixed-format types of input can be entered.


@demo demo/index.html 
-->

<dom-module id="pebble-textbox">
    <template>
    <style include="shared-styles"></style>

    <paper-input id="textbox" 
    
      disabled$="[[disabled]]" title$="[[title]]" value="{{value}}" invalid="{{invalid}}" prevent-invalid-input="[[preventInvalidInput]]"
      allowed-pattern="[[allowedPattern]]" validator="[[validator]]" pattern$="[[pattern]]" required$="[[required]]" autocomplete$="[[autocomplete]]"
      autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" name$="[[name]]"
      placeholder$="[[placeholder]]" readonly$="[[readonly]]" list$="[[list]]" size$="[[size]]" autocapitalize$="[[autocapitalize]]"
      autocorrect$="[[autocorrect]]" tabindex$="[[tabindex]]" autosave$="[[autosave]]" results$="[[results]]" accept$="[[accept]]"
      multiple$="[[multiple]]" always-float-label$="[[alwaysFloatLabel]]" auto-validate$="[[autoValidate]]" char-counter$="[[charCounter]]"
      error-message$="[[errorMessage]]" focused$="[[focused]]" label$="[[label]]" no-label-float$="[[noLabelFloat]]"
      
      on-change="_onChange"
      type="text">
    
    </paper-input>
    <bedrock-validator  input="[[value]]" pattern="[[pattern]]" min-length="[[minlength]]" max-length="[[maxlength]]" precision="[[precision]]" required="[[required]]"
                        invalid="{{invalid}}" error-message="{{errorMessage}}" min="[[min]]" max="[[max]]"  type="[[validationType]]" type-array="[[validationTypeArray]]"
    ></bedrock-validator>

    <!--type$="[[type]]"
          min$="[[min]]"
          max$="[[max]]"
          step$="[[step]]"-->

  </template>

    <script>
        (function() {
            'use strict';

            Polymer({
                is: 'pebble-textbox',
                //TODO: exception if behavior is used and the ruf-service-init is not on the page 
                //behaviors: [
                //  RUFBehaviors.Internationalization
                //],
                properties: {
                    /**
                     *  Indicates the default value for the textbox.                  
                     * 
                     */
                    value: {
                        type: String,
                        value: "",
                        notify: true
                    },
                     /**
                     * Returns true if the value is invalid. 
                     * If autoValidate is true, the invalid attribute is managed automatically.                
                     * 
                     */
                    invalid: {
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                   /**
                    * Indicates the label for the textbox.
                    * Allows to add descriptive text for the textbox to inform the user about the type of data 
                    * expected in the textbox. 
                    */
                    label: {
                        type: String
                    },
                  /**
                   * Indicates whether to disable the input or not. Set it to <b>true</b> to disable the input. 
                   * 
                   * 
                   */
                    disabled: {
                        type: Boolean,
                        value: false
                    },
                  /**
                    * Indicates whether entering invalid input can be prevented or not. 
                    * Set the value as <b>true</b> to prevent the user from entering invalid input.
                    */
                    preventInvalidInput: {
                        type: Boolean
                    },
                  /**
                    * Indicates whether the pattern is allowed by preventInvalidInput or not.
                    * Set the value as <b>true</b> to indicate the pattern allowed by preventInvalidInput.
                    */
                    allowedPattern: {
                        type: String
                    },
                  /**
                    * Indicates the datalist of the input, if any. This should match the id of an existing `<datalist>`.
                    */
                    list: {
                        type: String
                    },
                  /**
                    * Indicates a pattern to validate the `<input>` with.
                    */
                    pattern: {
                        type: String
                    },
                  /**
                    * Indicates whether to mark the input as required or not.
                    * Set the value as <b>true</b> to mark the input as required.
                    */
                    required: {
                        type: Boolean,
                        value: false
                    },
                  /**
                    * Indicates the error message to display when the input is invalid.
                    * 
                    */
                    errorMessage: {
                        type: String
                    },
                  /**
                    * Indicates whether to show a character counter or not.
                    * Set the value as <b>true</b> to show a character counter.
                    * 
                    */
                    charCounter: {
                        type: Boolean,
                        value: false
                    },
                  /**
                    * Indicates whether to disable the floating label or not.
                    * Set the value as <b>true</b> to disable the floating label.
                    */ 
                    noLabelFloat: {
                        type: Boolean,
                        value: false
                    },
                  /**
                    * Indicates whether to always float the label or not.
                    * Set the value as <b>true</b> to always float the label.
                    */
                    alwaysFloatLabel: {
                        type: Boolean,
                        value: false
                    },
                   /**
                     * Indicates whether to auto-validate the input value or not.
                     * Set the value as <b>true</b> to auto-validate the input value.
                     */ 
                    autoValidate: {
                        type: Boolean,
                        value: false
                    },
                  /**
                    * Indicates the name of the validator to use.
                    */
                    validator: {
                        type: String
                    },
                   /**
                     * Indicates whether to auto-complete the input value or not.
                     * Set the value as <b>true</b> to auto-complete the input value.
                     */ 
                    autocomplete: {
                        type: String,
                        value: 'off'
                    },
                   /**
                     * Indicates whether to auto-focus the textbox.
                     * Set the value as <b>true</b> to auto-focus the textbox.
                     */ 
                    autofocus: {
                        type: Boolean
                    },
                /**
                  * Indicates whether or not currently the element has focus.
                  * Set it to <b>true</b> to indicate the element that currently has focus.
                  */ 
                    focused: {
                        readOnly: true,
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                /**
                  * Indicates to the browser on devices with dynamic keyboards which keyboard to display. 
                  * It applies to the text, search and password input types as well as <textarea>.
                  */ 
                    inputmode: {
                        type: String
                    },
                /**
                  * Indicates the minimum length of the input value.
                  */ 
                    minlength: {
                        type: Number
                    },
                /**
                  * Indicates the maximum length of the input value.
                  */
                    maxlength: {
                        type: Number
                    },
                    // min: {
                    //   type: String
                    // },
                    // max: {
                    //   type: String
                    // },
                    // step: {
                    //   type: String
                    // },
                /**
                  * Indicates the name of the form control, and is submitted along with the form control's value when the form is submitted.
                  * It is the name part of the name/value pair associated with an element for the purposes of form submission. 
                  */
                    name: {
                        type: String
                    },
                /**
                  * Indicates a placeholder string in addition to the label. 
                  * If this is set, the label will always float.
                  */
                    placeholder: {
                        type: String,
                        // need to set a default so _computeAlwaysFloatLabel is run
                        value: ''
                    },
                /**
                  * Indicates whether to make the textbox non-editable. 
                  * Set it to <b>true</b> to make the textbox read-only.
                  */
                    readonly: {
                        type: Boolean,
                        value: false
                    },
                /**
                  * Indicates the width of the `pebble-input` form control. 
                  */
                    size: {
                        type: Number
                    },
                 /**
                   * Indicates whether or not entered text can be capitalized or not. 
                   */  
                    autocapitalize: {
                        type: String,
                        value: 'none'
                    },
                /**
                  * Indicates whether or not the entered text can be auto-corrected.
                  * Set the value as <b>on</b> to auto-correct the entered text.
                  */
                    autocorrect: {
                        type: String,
                        value: 'off'
                    },
                /**
                  * Indicates the types of files that the server accepts (that can be submitted through a file upload).
                  */
                    accept: {
                        type: String
                    },
                /**
                  * Indicates the relevance to the file, email and range input type.
                  */
                    multiple: {
                        type: Boolean
                    }
                },
                _onChange: function(event) {
                    //event bubbling
                    console.log("pebble-textbox _onChange");
                    if (this.shadowRoot) {
                        this.fire(event.type, {
                            sourceEvent: event
                        }, {
                            node: this,
                            bubbles: event.bubbles,
                            cancelable: event.cancelable
                        });
                    }
                },
                sayHi: function(e) {
                    //alert("onb1Click "+e.widget);
                    var currentdate = new Date();
                    this.value = "Hi I'm textbox " + currentdate.getDate() + "/" +
                        (currentdate.getMonth() + 1) + "/" +
                        currentdate.getFullYear() + " " +
                        currentdate.getHours() + ":" +
                        currentdate.getMinutes() + ":" +
                        currentdate.getSeconds();
                }
            });
        })();
    </script>

</dom-module>