<!Doctype html>
<html>

<head>
    <title>Pebble-LOV test</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
    <script src="/bower_components/web-component-tester/browser.js"></script>
    <script>
        // Setup Polymer options
        window.Polymer = {
            dom: 'shady',
            lazyRegister: true
        };

        // Load webcomponentsjs polyfill if browser does not support native Web Components
        (function () {
            'use strict';
            var onload = function () {
                // For native Imports, manually fire WebComponentsReady so user code
                // can use the same code path for native and polyfill'd imports.
                if (!window.HTMLImports) {
                    document.dispatchEvent(
                        new CustomEvent('WebComponentsReady', {
                            bubbles: true
                        })
                    );
                }
            };

            var webComponentsSupported = (
                'registerElement' in document &&
                'import' in document.createElement('link') &&
                'content' in document.createElement('template')
            );
            if (!webComponentsSupported) {
                var script = document.createElement('script');
                script.async = true;
                script.src = '/bower_components/webcomponentsjs/webcomponents-lite.min.js';
                script.onload = onload;
                document.head.appendChild(script);
            } else {
                onload();
            }
        })();
    </script>
    <link rel="import" href="/bower_components/polymer/polymer.html">
    <link rel="import" href="/bower_components/iron-test-helpers/iron-test-helpers.html">
    <link rel="import" href="../pebble-lov.html">
</head>

<body>
    <test-fixture id="basic">
        <template>
            <pebble-lov id="pebble-lov" items="{{items}}" show-image multi-select></pebble-lov>
        </template>
    </test-fixture>
    <script>
        var items, lov;
        items = [{
            "id": 1,
            "title": "Hydrogen",
            "subtitle": "H",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 2,
            "title": "Helium",
            "subtitle": "He",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 3,
            "title": "Lithium",
            "subtitle": "Li",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 4,
            "title": "Beryllium",
            "subtitle": "Be",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 5,
            "title": "Boron",
            "subtitle": "B",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 6,
            "title": "Carbon",
            "subtitle": "C",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 7,
            "title": "Nitrogen",
            "subtitle": "N",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 8,
            "title": "Oxygen",
            "subtitle": "O",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 9,
            "title": "Fluorine",
            "subtitle": "F",
            "image": "/src/images/lookup-item.jpg"
        }, {
            "id": 10,
            "title": "Neon",
            "subtitle": "Ne",
            "image": "/src/images/lookup-item.jpg"
        }];

        setup(function () {
            lov = fixture("basic");
            lov.items = items;
        });

        suite("defaults", function () {
            test("to check whether instantiating the lov works", function (done) {
                flush(function () {
                    assert.equal(lov.is, "pebble-lov");
                    done();
                });
            });

            test("to check whether items are provided to the lov", function (done) {
                flush(function () {
                    assert.notEqual(lov.items, '');
                    done();
                });
            });

            test("to check whether image is displayed for an item", function (done) {
                flush(function () {
                    var ironList = ElementHelper.getShadowElement(lov).querySelector(
                        'iron-list')
                    var item = ironList.querySelectorAll('.item')[5];
                    
                    var itemImage = item.querySelector('pebble-image-viewer')
                    if (itemImage) {
                        assert.isTrue(true);
                    }

                    done();
                });
            });

            test("to check whether checkbox is displayed for an item", function (done) {
                flush(function () {
                    var ironList = ElementHelper.getShadowElement(lov).querySelector(
                        'iron-list')
                    var item = ironList.querySelectorAll('.item')[5];
                    
                    var itemCheckbox = item.querySelector('paper-checkbox')
                    if (itemCheckbox) {
                        assert.isTrue(true);
                    }

                    done();
                });
            });
        });
    </script>
</body>

</html>