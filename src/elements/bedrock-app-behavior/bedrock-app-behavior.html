<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../bedrock-app-context-behavior/bedrock-app-context-behavior.html">

<script>
    /***
    * `RUFBehaviors.AppBehavior` provides common properties and methods that need to be implemented across all
    * apps. It is a mandatory behavior for all apps in RUF.
    *
    * `RUFBehaviors.AppBehavior` has multiple properties that can be used in the app flows.
    *
    *  ### Example
    *
    *     <dom-module id="x-app">
    *        <template>
    *        </template>
    *        <script>
    *           Polymer({
    *             is: "x-app",
    *
    *             behaviors: [
    *               RUFBehaviors.AppBehavior
    *             ],
    *
    *             properties: {
    *              
    *             }
    *           });
    *        &lt;/script>
    *     </dom-module>
    *
    * @polymerBehavior RUFBehaviors.AppBehavior
    */

    window.RUFBehaviors = window.RUFBehaviors || {};
    RUFBehaviors.AppBehavior = {

        properties: {

            /**
            * Specifies whether or not the component is Riversand UI Framework's app.
            */
            isRufApp: {
                type: Boolean,
                value: true,
                reflectToAttribute: true
            },

            contentHeightVariable: {
                type: String,
                value: ""
            }

        },

        attached: function () {
            if (this.contentHeightVariable != "") {
                var viewPortHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
                var appHeader = document.querySelector("main-app").$$("app-header");
                var rockTitle = this.$$("rock-layout").querySelector("rock-titlebar");
                var rockFooter = this.$$("rock-layout").$$("rock-footer");
                if (appHeader) {
                    viewPortHeight -= appHeader.offsetHeight;
                }
                if (rockTitle) {
                    viewPortHeight -= rockTitle.offsetHeight == 0 ? 40 : rockTitle.offsetHeight;
                }
                if (rockFooter) {
                    viewPortHeight -= rockFooter.offsetHeight == 0 ? 68 : rockFooter.offsetHeight;
                }
                else {
                    viewPortHeight -= 32;
                }

                this.customStyle[this.contentHeightVariable] = parseInt(viewPortHeight) - 22 + 'px';
                this.updateStyles();
            }

        }
    };
    RUFBehaviors.AppBehavior = [RUFBehaviors.UIBehavior, RUFBehaviors.AppContextBehavior, RUFBehaviors.AppBehavior];

</script>