<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/polymer/lib/elements/custom-style.html">
<link rel="import" href="../../../bower_components/polymer/lib/utils/async.html">
<link rel="import" href="../../../bower_components/polymer/lib/utils/debounce.html">

<dom-module id="data-table-column-filter">
  <template>
  <style is="custom-style">
    :host([hidden]) {
      display: none;
    }   
    :host {
      width: 100%;
      margin-bottom: 10px;
      --paper-input-container-input: {
        font-size: var(--font-size-sm, 12px) !important;
        @apply(--pebble-textbox-paper-input-style); 
        line-height: 16px!important;  
        height: 16px;    
        font-style: italic;     
      };
      --paper-input-container-underline-focus: {
        border-bottom: 1px solid var(--focused-line, #026bc3);
      };
      --paper-input-container-invalid-color: {
        border-bottom: 1px solid var(--invalid-line);
      };
      --paper-input-container: {
        vertical-align: middle;
        padding-top:0px;
        padding-right:0px;
        padding-bottom:0px;
        padding-left:0px;
        margin-top:0px;
        margin-right:0px;
        margin-bottom:0px;
        margin-left:0px;
        @apply(--paper-input-container-style);
      };
      --paper-input-container-underline: {
        border-bottom: 1px solid var(--textbox-border);
      };      
      --paper-input-container-label: {
        text-transform: capitalize;
        font-size:var(--default-font-size, 14px) !important;
        color: var(--focused-line);
        line-height: 17px;
        font-weight: 500;
      };
      --paper-input-container-label-focus: {
        color: var(--focused-line);
      };
      --iron-autogrow-textarea-placeholder: {
        line-height: 0px !important;
      }
    }
    @supports (-ms-ime-align: auto) { /* For EDGE browser */
      :host {
        --paper-input-container: {
          padding-top:0px;
          padding-right:0px;
          padding-bottom:0px;
          padding-left:0px;
        }
      };
      paper-icon-button {
        padding: 0!important;
      }
    }
    paper-icon-button {
      width: 16px;
      height: 16px;
      margin-right: 5px;
      fill: var(--primary-icon-color, #75808b);
      color: var(--primary-icon-color, #75808b);
      cursor: pointer;
    };
  </style>
    <label>[[label]]</label>
    <paper-input placeholder="Search" no-label-float value="[[value]]" on-value-changed="_valueChanged"><paper-icon-button slot="prefix" class="pebble-md-icons" noink icon="pebble-md-icons:ToolbarSearch"></paper-icon-button></paper-input>
  </template>
  <script>
    Polymer({
      is: 'data-table-column-filter',

      properties: {
        label: {
          type:String,
        },
        value: {
          type: String,
          notify: true
        },
        hidden: {
          type: Boolean
        }
      },

      _valueChanged: function(e) {
        // store value in a variable, referring to e.detail.value inside the debounce
        // function results in weird outcomes. event object might be reused by Polymer?
        var value = e.detail.value;
        this._debouncer = Polymer.Debouncer.debounce(this._debouncer, Polymer.Async.timeOut.after(250), () => {
          this.value = value;
        });
      }
    });
  </script>
</dom-module>
