<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../bedrock-internalref-dataobject-falcor-util/bedrock-internalref-dataobject-falcor-util.html">

<script>
    /***
     * Provides common utilities for data objects
     */
    LiquidDataObjectUtils = {};
    //required for gulp script parsing
    //files with window.RUFBehaviors in them are not delayed for loading
    window.RUFBehaviors = window.RUFBehaviors || {};

    (function () {
        LiquidDataObjectUtils.invalidateDataObjectCache = function (dataObject, dataIndex) {
            let pathKeys = SharedUtils.DataObjectFalcorUtil.getPathKeys();

            if (dataObject && pathKeys) {
                dataIndex = dataIndex || "entityData";
                
                let dataObjectId = dataObject.id;
                let dataObjectType = dataObject.type;
                let dataFalcorModel = RUFBehaviors.DataChannel.getModel(dataIndex);
                
                if(dataFalcorModel) {
                    dataFalcorModel.invalidate([pathKeys.root, dataIndex, dataObjectType, pathKeys.byIds, dataObjectId]);
                }

                if (dataIndex == "entityData") {
                    let governDataFalcorModel = RUFBehaviors.DataChannel.getModel("entityGovernData");
                    governDataFalcorModel && (governDataFalcorModel.invalidate([pathKeys.root, governDataIndex, dataObjectType, pathKeys.byIds, dataObjectId]));
                }
            }
        };

        LiquidDataObjectUtils.invalidateAllCache = function () {
            RUFBehaviors.DataChannel.clearAllCache();
        };
    })();
</script>