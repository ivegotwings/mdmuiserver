<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>pebble-stepper test</title>

    <script src="../../../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../../../../bower_components/web-component-tester/browser.js"></script>
    <script src="../../../../bower_components/iron-test-helpers/mock-interactions.js"></script>
    <link rel="import" href="../../../../bower_components/iron-ajax/iron-ajax.html">
    <link rel="import" href="../../../../bower_components/iron-test-helpers/iron-test-helpers.html">

    <link rel="import" href="../pebble-stepper.html">
    <link rel="import" href="../pebble-step.html">
    <link rel="import" href="sample-steps.html">
  </head>
  <body>
    <test-fixture id="basic">
      <template>
        <pebble-stepper></pebble-stepper>
      </template>
    </test-fixture>
    <test-fixture id="steps">
      <template>
        <sample-steps></sample-steps>
      </template>
    </test-fixture>

    <script>
      function runAfterOpen(node, callback) {
        node.addEventListener('iron-select', function() {
          Polymer.Base.async(callback, 1);
        });
        MockInteractions.tap(node);
      }
      
      suite('pebble-stepper', function() {
        test('instantiating the element works', function() {
          var element = fixture('basic');
          assert.equal(element.is, 'pebble-stepper');
        });
      });

      suite('pebble-stepper', function() {
        var stepper = fixture('steps');
        test('number of steps should be same as given', function() {
            assert.equal(stepper.stepper.items.length,4);
        });

        test('vertical value should be true', function() {
            assert.equal(stepper.stepper.vertical,true);
        });

        test('opened attribute value should be true of selected step', function() {
            runAfterOpen(stepper.stepper.items[0].$.stepLabel.$.textWrapper, function() {
              assert.equal(stepper.stepper.items[0].opened, true);
            });
        });

        test('opened attribute value should be false for other than selected step', function() {
            runAfterOpen(stepper.stepper.items[0].$.stepLabel.$.textWrapper, function() {
              assert.equal(stepper.stepper.items[1].opened, false);
              assert.equal(stepper.stepper.items[2].opened, false);
              assert.equal(stepper.stepper.items[3].opened, false);
            });
        });

        test('index of 1st step is 1 and last step is equal to number of steps', function() {
            assert.equal(stepper.stepper.items[0].index,1);
            assert.equal(stepper.stepper.items[3].index,4);
        });

        test('child steps of particular step should be same as given', function() {
            assert.equal(stepper.stepper.items[0].$.stepLabel.data.items.length,3);
            assert.equal(stepper.stepper.items[1].$.stepLabel.data.items.length,4);
            assert.equal(stepper.stepper.items[2].$.stepLabel.data.items.length,3);
            assert.equal(stepper.stepper.items[3].$.stepLabel.data.items.length,3);
        });
      });
    </script>
  </body>
</html>