<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-selector/iron-selectable.html">
<link rel="import" href="../../../bower_components/iron-collapse/iron-collapse.html">

<link rel="import" href="pebble-step.html">

<!--
`pebble-stepper` Represents a stepper element that supports the display of the multiple steps of flow and
different actions at the child steps level. It shows the number of child steps present in each step. When it is expanded, child steps are also expanded to
do different actions and to have their own content.

It exhibits as a simple plain layout or combination of its child elements such as
 `<pebble-step>`, `<pebble-step-badge-content>`, and `<pebble-step-details>`.

It supports both horizontal and vertical layouts.

### Styling

Custom property             | Description                          | Default
----------------------------|--------------------------------------|----------
`--pebble-vertical-step-transition-duration`  | Sets the transition duration for the step when selected| `500ms`
`--paper-badge-background`      | Sets the background of the child steps count badge  | `auto`
`--paper-badge-text-color`     | Sets the text-color of the child steps count badge | `auto`
`--paper-badge`| Mixin applied to the badge that shows count of child steps| 'auto'
`--connectorLine-width`| Sets the connector line width| `1px`
`--divider-color`| Sets the color of the connector line | `--paper-grey-300`
`--pebble-step-outer-badge-background` | Sets the background color of the outer badge | `#fff`
`--pebble-step-outer-badge-color` | Sets the color of the outer badge | `--paper-grey-300`
`--pebble-connected-badge-width` | Sets the width of the connected badge at top level| `auto`
`--pebble-connected-badge-height` | Sets the height of the connected badge at top level| `auto`
`--pebble-step-connected-badge-background` | Sets the background color of the connected badge at top level| `auto`
`--pebble-step-connected-badge-color` | Sets the color of the connected badge text at top level| `auto`
`--pebble-step-connected-badge-fontSize` | Sets the font size of the text in connected badge at top level| `auto`
`--pebble-connected-childBadge-width` | Sets the width of the connected badge at child level| `auto`
`--pebble-connected-childBadge-height` | Sets the height of the connected badge at child level| `auto`
`--pebble-connected-childBadge-background` | Sets the background color of the connected badge at child level| `auto`
`--pebble-connected-childBadge-color` | Sets the color of the connected badge text at child level| `auto`
`--pebble-connected-childBadge-fontSize` | Sets the font size of the text in connected badge at child level| `auto`
`--connectorLine-width` | Sets the width of connector line for elements at parent level | `1px`
`--child-connectorLine-width` | Sets the width of connector line for elements at parent level | `1px`
`--pebble-step-completed-label-color` | Sets the color of the step label for the step which is completed | `--paper-green-500`
`--pebble-step-completed-badge-color` | Sets the color of the connected badge of the completed step | `--paper-green-500`
`--pebble-step-completed-outer-badge-color` | Sets the color of the outer connected badge of the completed step | `paper-green-500`
`--pebble-step-completed-outer-badge-background-color` | Sets the color for the back gorund of the outer badge of completed step | `#fff`
`--pebble-step-inprogress-label-color` | Sets the color of the step label for the step which is in-progress | `--paper-blue-500`
`--pebble-step-inprogress-badge-color` | Sets the color of the connected badge of the in-progress step | `--paper-blue-500`
`--pebble-step-inprogress-outer-badge-color` | Sets the color of the outer connected badge of the in-progress step | `paper-blue-500`
`--pebble-step-inprogress-outer-badge-background-color` | Sets the color for the back gorund of the outer badge of in-progress step | `#fff`
`--pebble-horizontal-step-connector-line-width` | Sets the width of the connector line when stepper layout is horizontal | `auto`
`--pebble-horizontal-step-connector-line-width` | Sets the height of the connector line when stepper layout is horizontal | `auto`
`--pebble-horizontal-step-child-connector-line-width` | Sets the width of child connector line when stepper layout is horizontal | `auto`
`--pebble-horizontal-step-child-connector-line-height` | Sets the height of child connector line when stepper layout is horizontal | `auto`

### Accessibility

See the docs for `Polymer.IronSelectableBehavior` for accessibility features implemented by this element.

@group pebble Elements
@element pebble-stepper
@demo demo/index.html
-->
<dom-module id="pebble-stepper">
  <template>
    <style>
      :host([horizontal]) {
        @apply(--layout-horizontal);
      }
    </style>
      <content></content>
  </template>

  <script>
    'use strict';
    Polymer({

      is: 'pebble-stepper',

      behaviors: [
        Polymer.IronSelectableBehavior
      ],
      
      properties: {
        /**
        * Indicates the layout of the stepper.
        * If it is set to <b>true</b>, then the stepper will be in horizontal position.
        */
        horizontal: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        /**
        * Indicates a readonly property whose value is set to step which is selected 
        * from multiple steps in a stepper.
        */
        selectedAttribute: {
          type: String,
          value: 'opened',
          readOnly: true
        },

        /**
        * Indicates the number of steps present in the given flow.
        * The defualt value is computed number of steps in a flow.
        */
        steps: {
          type: Number,
          readOnly: true
        },
        /**
         * Indicates the Object for configuring stepper
         */
        stepperConfig: {
          type: Object,
          value: function() { return {}; },
          observer: '_configChanged'
        },
        orderBy: {
          type: String,
          value: "ascending"
        }
      },
      observers: [
        '_itemsChanged(items)'
      ],
      _configChanged: function(stepperConfig) {
        if(stepperConfig && stepperConfig.items && stepperConfig.items.length > 0) {
          for(var i=0; i<stepperConfig.items.length; i++) {
            var item = stepperConfig.items[i];
            if(item.selected == true) {
              this.selected = i;
              break;
            }
          }
        }
      },
      _itemsChanged: function(items) {
        if(items && items.length && items.length > 0) {
          this._setSteps(items.length);
          for(var i=0; i<items.length; i++) {
            items[i]._index = i+1;
            items[i]._steps = items.length;
            items[i]._horizontal = this.horizontal;
          }
        }
      }
    });

  </script>
</dom-module>
