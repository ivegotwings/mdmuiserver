<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-selector/iron-selectable.html">
<link rel="import" href="../../../bower_components/iron-collapse/iron-collapse.html">

<link rel="import" href="pebble-step.html">

<!--
`pebble-stepper` Represents a stepper element that supports the display of the multiple steps of flow and
different actions at the child steps level. It shows the number of child steps present in each step. When it is expanded, child steps are also expanded to
do different actions and to have their own content.

It supports both horizontal and vertical layouts.

### Styling

Custom property             | Description                          | Default
----------------------------|--------------------------------------|----------
`--pebble-vertical-step-transition-duration`  | Sets the transition duration for the step when selected| `500ms`
`--paper-badge-background`      | Sets the background of the child steps count badge  | `auto`
`--paper-badge-text-color`     | Sets the text-color of the child steps count badge | `auto`
`--paper-badge`| Mixin applied to the badge that shows count of child steps| 'auto'
`--connectorLine-width`| Sets the connector line width| `1px`
`--divider-color`| Sets the color of the connector line | `--paper-grey-300`
`--pebble-vertical-step-max-height`| Sets the maximum height of the step wrapper| `400px`
`--connected-badge-width` | Sets the width of the connected badge at the top level| `auto`
`--connected-badge-height` | Sets the height of the connected badge at the top level| `auto`
`--connected-badge-background` | Sets the background color of the connected badge at the top level| `auto`
`--connected-badge-color` | Sets the color of the connected badge text at the top level| `auto`
`--connected-badge-fontSize` | Sets the font size of the text in connected badge at the top level| `auto`
`--connected-childBadge-width` | Sets the width of the connected badge at the child level| `auto`
`--connected-childBadge-height` | Sets the height of the connected badge at the child level| `auto`
`--connected-childBadge-background` | Sets the background color of the connected badge at the child level| `auto`
`--connected-childBadge-color` | Sets color of the connected badge text at child level| `auto`
`--connected-childBadge-fontSize` | Sets the font size of the text in connected badge at the child level| `auto`
`--connectorLine-width` | Sets the width of connector line for elements at the parent level | `1px`
`--child-connectorLine-width` | Sets the width of connector line for elements at the parent level | `1px`

### Accessibility

See the docs for `Polymer.IronSelectableBehavior` for accessibility features implemented by this element.

@group pebble Elements
@element pebble-stepper
@demo demo/index.html
-->
<dom-module id="pebble-stepper">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <template is="dom-if" if="{{vertical}}">
      <content></content>
    </template>
  </template>

  <script>
    'use strict';
    Polymer({

      is: 'pebble-stepper',

      behaviors: [
        Polymer.IronSelectableBehavior
      ],

      observers: [
        '_updateSelectedStep(selectedItem)'
      ],
      
      properties: {
        /**
        * Indicates the layout of the stepper.
        * If it is set to <b>true</b>, then the stepper will be in vertical position.
        */
        vertical: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        /**
        * Indicates a readonly property whose value is set to step which is selected 
        * from multiple steps in a stepper.
        */
        selectedAttribute: {
          type: String,
          value: 'opened',
          readOnly: true
        },

        /**
        * Indicates a number of steps present in the given flow.
        * The defualt value is computed number of steps in a flow.
        */
        steps: {
          type: Number,
          readOnly: true,
          computed: '_computeSteps(items, items.length)'
        },
        /**
        * Indicates an index of the step that must be opened by default.
        */
        selectedStep: {
          type: Number,
          value: null
        },
      },

      _computeSteps: function(items,length) {
          if(length>0){
            for(var i=0;i<length;i++){
              items[i].index = i+1;
              items[i].steps = length;
              if(this.selectedStep != null && i==this.selectedStep){
                this.select(this.selectedStep);
              }
            }
          }
          return length;
      },

      _updateSelectedStep: function(item) {
        this.selectedStep = item;
      }
    });

  </script>
</dom-module>
