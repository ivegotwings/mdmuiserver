<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-selector/iron-selectable.html">
<link rel="import" href="../../../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="pebble-step.html">

<!--
`pebble-stepper` represents a material design stepper element supports showing multiple steps of flow,
different actions at child steps level.

Shows number of child steps present in each step, once expands child steps can also be expanded to
do different actions, to have their own content etc.

Supports both Horizontal and vertical layouts.

Custom property             | Description                          | Default
----------------------------|--------------------------------------|----------
`--pebble-vertical-step-transition-duration`  | sets the transition duration for the step when selected| `500ms`
`--paper-badge-background`      | Sets the background of the child steps count badge  | `auto`
`--paper-badge-text-color`     | Sets the text-color of the child steps count badge | `auto`
`--paper-badge`| Mixin applied to the badge that shows count of child steps| 'auto'
`--connectorLine-width`| Sets the connector line width| `1px`
`--divider-color`| Sets the color of the connector line | `--paper-grey-300`
`--pebble-vertical-step-max-height`| Sets the max height of the step wrapper| `400px`
`--connected-badge-width` | Sets width of the connected badge at top level| `auto`
`--connected-badge-height` | Sets height of the connected badge at top level| `auto`
`--connected-badge-background` | Sets background color of the connected badge at top level| `auto`
`--connected-badge-color` | Sets color of the connected badge text at top level| `auto`
`--connected-badge-fontSize` | Sets font size of the text in connected badge at top level| `auto`
`--connected-childBadge-width` | Sets width of the connected badge at child level| `auto`
`--connected-childBadge-height` | Sets height of the connected badge at child level| `auto`
`--connected-childBadge-background` | Sets background color of the connected badge at child level| `auto`
`--connected-childBadge-color` | Sets color of the connected badge text at child level| `auto`
`--connected-childBadge-fontSize` | Sets font size of the text in connected badge at child level| `auto`
`--connectorLine-width` | Sets the width of connector line for elements at parent level | `1px`
`--child-connectorLine-width` | Sets the width of connector line for elements at parent level | `1px`
-->
<dom-module id="pebble-stepper">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <template is="dom-if" if="{{vertical}}">
      <content></content>
    </template>
  </template>

  <script>
    'use strict';
    Polymer({

      is: 'pebble-stepper',

      behaviors: [
        Polymer.IronSelectableBehavior
      ],
      
      properties: {
        /**
        * Indicates the layout of the stepper.
        * If set to true, stepper will be in vertical position.
        */
        vertical: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },
        /**
        * Represents a Readonly property which value will be set to step which is selected 
        * among multiple steps in stepper.
        */
        selectedAttribute: {
          type: String,
          value: 'opened',
          readOnly: true
        },

        /**
        * Represents number of steps present in the given flow.
        * Computed number of steps in flow is default value.
        */
        steps: {
          type: Number,
          readOnly: true,
          computed: '_computeSteps(items, items.length)'
        },
        /**
        * Represents index of step that should be opened default.
        */
        selectedStep: {
          type: Number,
          value: null
        },
        /**
        * Represents index of child step that should be opened default.
        */
        childSelectedStep: {
          type: Number,
          value: null
        }
      },

      _computeSteps: function(items,length) {
          if(length>0){
            for(var i=0;i<length;i++){
              items[i].index = i+1;
              items[i].steps = length;
              if(this.selectedStep != null && i==this.selectedStep){
                this.select(this.selectedStep);
                if(this.childSelectedStep){
                  items[i].selectedStep = this.childSelectedStep;
                }
              }
            }
          }
          return length;
      },
    });

  </script>
</dom-module>
