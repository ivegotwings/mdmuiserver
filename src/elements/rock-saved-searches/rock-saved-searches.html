<link rel="import" href="../rock-elements/rock-elements.html">


<dom-module id="rock-saved-searches">
    <template>
        <style include="shared-styles"></style>
        <style>
			<!--:host {-->
				<!--margin-right: -15px;-->
				<!--padding-bottom: 12px;-->
				<!--@apply(&#45;&#45;layout);-->
				<!--@apply(&#45;&#45;layout-horizontal);-->
			<!--}-->


        </style>

        <rock-widget id="ex1" config="{{_widgetConfig}}">

        </rock-widget>


    </template>

    <script>
    (function() {
      'use strict';

      Polymer({
        is: 'rock-saved-searches',

        properties: {
        /**
         *   This is a private property, indicates the current active tab under saved searches
        */
        _selectedTab : {
            type:String,
            notify: true,
            value : "favourites",
            observer: '_tabOrDataChanged'
        },

        /**
         * Contains the data of saved searches
        */
        savedSearches : {
            type : Object,
            notify : true,
             value : function(){return {}},
             observer: '_tabOrDataChanged'
        },
        /**
         * This is a private property. Contains the computed tags from active tab of saved searches
        */
         _tags:{
            type:Array,
            notify: true,
            value:function(){return []},
         },
         /**
          * This is a private property. Indicates the config that needs to be passed to rock-widget.
         */
         _widgetConfig:{
            type:Object,
            notify: true,
            value:function(){
                return {
                "heading": "Saved Searches",
                "headerIcon": "icons:assignment",
                "component": {
                  "name": "rock-filter-tags",
                  "path": "../../rock-filter-tags/rock-filter-tags.html",
                  "properties": {
                  "style": "min-height:150px;min-width:720px;"} } } }
          }
        },

        listeners: {
            'tag-item-select': '_onTagItemSelect'
        },

        /**
         * This is a private function. It is responsible for computing tags when saved searches or tab changed.
        */
        _tabOrDataChanged : function() {
            this._tags=[];
            if(this.savedSearches && this._selectedTab && this.savedSearches[this._selectedTab]) {
            for(var i =0; i < this.savedSearches[this._selectedTab].length; i++) {
                var tag = JSON.parse(JSON.stringify(this.savedSearches[this._selectedTab][i]));
                tag["editMode"] = false,
                this.push('_tags',tag);
            }
            this._widgetConfig.component.properties.tags=this._tags;
            }
        },

        _onTagItemSelect : function(e) {
            //this.splice('tags', e.detail.index, 1);
            //console.log(this._tags[e.detail.index]);
            alert('selected ' +  JSON.stringify(this._tags[e.detail.index]));
        }
      });
    })();

    </script>

</dom-module>