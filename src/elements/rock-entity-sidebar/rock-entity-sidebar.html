<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../../bower_components/shadycss/apply-shim.html">

<link rel="import" href="../bedrock-helpers/data-helper.html">
<link rel="import" href="../bedrock-helpers/data-request-helper.html">
<link rel="import" href="../bedrock-helpers/data-transform-helper.html">
<link rel="import" href="../bedrock-helpers/context-helper.html">
<link rel="import" href="../bedrock-helpers/attribute-helper.html">
<link rel="import" href="../bedrock-helpers/component-helper.html">
<link rel="import" href="../bedrock-component-context-behavior/bedrock-component-context-behavior.html">
<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../bedrock-pubsub/bedrock-pubsub.html">
<link rel="import" href="../bedrock-helpers/format-helper.html">

<link rel="import" href="../rock-component-config-behavior/rock-component-config-behavior.html">
<!-- <link rel="import" href="../bedrock-style-manager/styles/bedrock-style-common.html">


<link rel="import" href="../liquid-entity-data-get/liquid-entity-data-get.html">
<link rel="import" href="../liquid-entity-model-composite-get/liquid-entity-model-composite-get.html">
<link rel="import" href="../liquid-entity-govern-data-get/liquid-entity-govern-data-get.html">
<link rel="import" href="../liquid-entity-model-get/liquid-entity-model-get.html">
<link rel="import" href="../liquid-dataobject-utils/liquid-dataobject-utils.html">
<link rel="import" href="../liquid-rest/liquid-rest.html">

<link rel="import" href="../pebble-actions/pebble-actions.html">
<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-image-viewer/pebble-image-viewer.html">
<link rel="import" href="../pebble-toolbar/pebble-toolbar.html">
<link rel="import" href="../pebble-popover/pebble-popover.html">
<link rel="import" href="../pebble-horizontal-divider/pebble-horizontal-divider.html">
<link rel="import" href="../pebble-info-icon/pebble-info-icon.html"> -->

<link rel="import" href="../rock-tabs/rock-tabs.html">

<dom-module id="rock-entity-sidebar">
    <template>
        <style include="bedrock-style-common"></style>
        <style>
            :host {
                width: 100%;
                height:100%;
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
                padding-right: 0;
                padding-left: 0;
                box-sizing: border-box;
            }
            rock-tabs{                
                width:100%;
                --pebble-tab:{
                    margin-left:20px;
                }
                --pebble-tab-group:{
                margin-bottom: 0px;
                };
                --rock-tab-content: {
                      height: calc(100% - 43px); 
                }
            }
        </style>
            <rock-tabs id="sidebarTabs" config="{{config}}" readonly$="[[readonly]]"></rock-tabs>
        </template>
    <script>
        Polymer({
            is: "rock-entity-sidebar",
            ready: function () {
            },
            behaviors: [
                RUFBehaviors.ComponentContextBehavior,
                RUFBehaviors.UIBehavior,
                RUFBehaviors.ComponentConfigBehavior
            ],
            properties: {
                /**
                 * <b><i>Content development is under progress... </b></i>
                 */
                 contextData: {
                    type: Object,
                    value: function() {
                        return {};
                    },
                    observer: '_onContextDataChange'
                },
                /**
                 * If set as true , it indicates the component is in read only mode
                 */
                readonly: {
                    type: Boolean,
                    value: false
                },
                /**
                 * Indicates the attributes that gets displayed in the header section.
                 */
                 config: {
                    type: Object,
                    value: function(){
                        return {};
                    }
                },
                getTabConfig:function(){
                    if(this.config && this.config.tabItems){
                        return tabItems;
                    }
                }     
            },
            _onContextDataChange: function(){
                if(!_.isEmpty(this.contextData)) {
                    var context = DataHelper.cloneObject(this.contextData);
                        //App specific
                        var appName = ComponentHelper.getCurrentActiveAppName();
                        if(appName) {
                            context[ContextHelper.CONTEXT_TYPE_APP] = [{
                                "app": appName
                            }];
                        }
                        this.requestConfig("rock-entity-sidebar", context);
                }
            },
            onConfigLoaded: function (componentConfig) {
                if(componentConfig && componentConfig.config) {
                    componentConfig.config.tabItems = DataHelper.convertObjectToArray(componentConfig.config.tabItems);;
                    
                    this.config = componentConfig.config;
                        
                }
            },
        });
    </script>
</dom-module>