<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-image-viewer/pebble-image-viewer.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../pebble-horizontal-divider/pebble-horizontal-divider.html">


<dom-module id="pebble-error-list">
    <template>
        <style is="custom-style" include="iron-flex iron-flex-alignment">
            
            pebble-horizontal-divider {
                --pebble-horizontal-divider-color: #ccc;
                @apply(--entity-tofix-horizontal-divider);
            }

            .container{
                @apply(--layout-horizontal);
                align-items: center;
                -webkit-align-items: center; /* Safari 7.0+ */
                max-height: 250px;
                max-width: 288px;
                padding: 5px 0;
                cursor: pointer;
                @apply(--entity-container);
            }

            .entity-icon-outer{
                @apply(--layout);
                @apply(--layout-center-center);
                @apply(--paper-font-common-base);
                padding: 5px;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                margin-right: 10px;
                @apply(--entity-icon-outer-circle);
            }

            pebble-icon {
                --pebble-icon-width: var(--entity-icon-width, 20px);
                --pebble-icon-height: var(--entity-icon-height, 20px);
                --pebble-icon-margin: var(--entity-icon-margin);
            }

            .error{
                background-color: var(--error-icon-outer-bg-color, rgba(251, 96, 103, 1));
            }

            .error > pebble-icon{
                --pebble-icon-fill-color: var(--entity-error-icon-fill-color, #ffffff);
                --pebble-icon-stroke-color: var(--entity-error-icon-stroke-color, rgba(251, 96, 103, 1));
            }

            .warning{
                background-color: var(--warning-icon-outer-bg-color, orange);
            }

            .warning > pebble-icon{
                --pebble-icon-fill-color: var(--entity-warning-icon-fill-color, #ffffff);
                --pebble-icon-stroke-color: var(--entity-warning-icon-stroke-color, orange);
            }

            .entity-content{
                align-self: flex-center;
                -webkit-align-self: flex-center;
                @apply(--entity-content);
            }

            .entity-content {
                font-size: 12px !important;
            }
            .outer-container{
                width: 300px;
                word-wrap: break-word;
            }
             .fixNow {
                --pebble-button: {
                    height: 20px;
                    width: 50px;
                    font-size: var(--font-size-sm);
                    font-weight: var(--font-medium, 500);
                    text-transform: uppercase;
                    font-style: normal;
                    font-stretch: normal;
                    line-height: 20px;
                    letter-spacing: normal;
                    text-align: center;
                    background: var(--palette-water-blue);
                    color: var(--white);
                }
            }
        </style>
        <div class="outer-container">
        <template is="dom-repeat" items="[[errors]]">
            <div class="container" data="[[item]]" on-tap="_onTap">
                <div class="entity-icon-outer error">
                    <pebble-icon icon="pebble-icons:WarningMessage"></pebble-icon>
                </div>
                <template is="dom-if" if="{{isObject(item)}}">

                <div class="entity-content">
                    [[item.name]]: [[item.error]]
                </div>
                </template>
                <template is="dom-if" if="{{!isObject(item)}}">
                    <div class="entity-content">
                        [[item]]
                    </div>
                </template>
            </div>
            <template is="dom-if" if="{{!isObject(item)}}">
                <div style="float: right;">
                    <pebble-button id="fixNow" class="fixNow" button-text="Fix Now" on-tap="fixNow" elevation=1 raised></pebble-button>
                    <!--<a href="javascript:void(0)" on-tap="fixNow">  Fix Now</a>-->
                </div>
            </template>
        </template>
            <template is="dom-repeat" items="[[warnings]]">
            <div class="container" data="[[item]]" on-tap="_onTap">
                <div class="entity-icon-outer warning">
                    <pebble-icon icon="pebble-icons:WarningMessage"></pebble-icon>
                </div>
                <div>[[item.name]]</div>
                <div class="entity-content">
                    [[item.error]]
                </div>
            </div>
        </template>
    </div>
    </template>
    <script>
        Polymer({
            is: 'pebble-error-list',

            properties: {

            },
            behaviors: [
                RUFBehaviors.UIBehavior
            ],

            /**
             * Can be used to raise on-tap events as per configuration.
             */
            _onTap: function (e) {
                var eventDetail = {
                    data: e.currentTarget.data
                };
                this.fire('error-tapped',eventDetail);
            },
            fixNow: function (e) {
                this.fire('fix-error',e);
            },
            isObject: function (item) {
                if(item.hasOwnProperty("error") ){
                    return true;
                }
                return false;
            }
        });
    </script>
</dom-module>