<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-image-viewer/pebble-image-viewer.html">
<link rel="import" href="../pebble-icon/pebble-icon.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../pebble-horizontal-divider/pebble-horizontal-divider.html">
<link rel="import" href="../pebble-styles-shared/pebble-styles-shared.html">



<dom-module id="pebble-error-list">
    <template>
        <style is="custom-style" include="iron-flex iron-flex-alignment pebble-styles-shared">
            
            pebble-horizontal-divider {
                --pebble-horizontal-divider-color: var(--palette-pale-grey-three, #e7ebf0);
                @apply(--entity-tofix-horizontal-divider);
            }

            .container{
                @apply(--layout-horizontal);
                align-items: center;
                -webkit-align-items: center; /* Safari 7.0+ */
                max-height: 250px;
                max-width: 288px;
                padding: 5px 0;
                cursor: pointer;
                @apply(--entity-container);
            }

            .entity-icon-outer{
                @apply(--layout);
                @apply(--layout-center-center);
                @apply(--paper-font-common-base);
                padding: 0px;
                border-radius: 50%;
                width: 18px;
                height: 19px;
                margin-right: 10px;
                @apply(--entity-icon-outer-circle);
            }

            pebble-icon {
                --pebble-icon-width: var(--entity-icon-width, 15px);
                --pebble-icon-height: var(--entity-icon-height, 19px);
                --pebble-icon-margin: var(--entity-icon-margin);
            }

            .error{
                background-color: var(--error-button-color, #f30440);
            }

            .error > pebble-icon{
                --pebble-icon-fill-color: var(--button-text-color, #ffffff);
                --pebble-icon-stroke-color: var(--error-button-color, #f30440);
            }

            .warning{
                background-color: var(--warning-button-color, #f78e1e);
            }

            .warning > pebble-icon{
                --pebble-icon-fill-color: var(--button-text-color, #ffffff);
                --pebble-icon-stroke-color: var(--warning-button-color, #f78e1e);
            }

            .entity-content{
                align-self: flex-center;
                -webkit-align-self: flex-center;
                @apply(--entity-content);
            }

            .entity-content {
                font-size: var(--font-size-sm,12px) !important;
            }
            .outer-container{
                width: 296px;
                word-wrap: break-word;
                padding: 10px;
            }
            #fixNow{
                margin-bottom: 5px;
            }
             
        </style>
        <div class="outer-container">
        <template is="dom-repeat" items="[[errors]]">
            <div class="container" data="[[item]]">
                <div class="entity-icon-outer error">
                    <pebble-icon icon="pebble-icons:WarningMessage"></pebble-icon>
                </div>
                <template is="dom-if" if="{{_isObject(item)}}">
                <div class="entity-content">
                    [[item.externalName]]: [[item.message]]
                </div>
                </template>
                <template is="dom-if" if="{{!_isObject(item)}}">
                    <div class="entity-content">
                        [[item]]
                    </div>
                </template>
            </div>
        </template>
        <div class="pull-right">
            <pebble-button id="fixNow" class="btn btn-sm btn-primary" button-text="Fix Now" on-tap="_fixNow" elevation=1 raised></pebble-button>
        </div>
    </div>
    </template>
    <script>
        Polymer({
            is: 'pebble-error-list',

            properties: {
                errors:{
                    type:Array,
                    value:function () {
                        return [];
                    }
                }
            },
            behaviors: [
                RUFBehaviors.UIBehavior
            ],

            /**
             * Fire an event to fix the error.
             */
            _fixNow: function (e) {
                this.fireBedrockEvent('fix-error',{"data":this.errors});
            },
            _isObject: function (item) {
                return item !== null && typeof item === 'object'
            }
        });
    </script>
</dom-module>