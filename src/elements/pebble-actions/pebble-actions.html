<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">

<link rel="import" href="../pebble-button/pebble-button.html">
<link rel="import" href="../pebble-popover/pebble-popover.html">
<link rel="import" href="../pebble-icons/pebble-icons.html">
<link rel="import" href="../bedrock-ui-behavior/bedrock-ui-behavior.html">
<link rel="import" href="../bedrock-pubsub/bedrock-pubsub.html">

<!--
`pebble-actions` Represents a material design element which contains a button and a list of action items 
that needs to be performed on any page or element based on user configuration.

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--pebble-actions-button`|Mix in applied to the button| {}
`--pebble-actions-button-icon`|Mix in applied to the icon of the button| {}
`--pebble-actions-button-drop-down-icon`|Mix in applied to the drop-down icon of the button| {}

@group Pebble Elements
@element pebble-actions
@demo demo/index.html
-->
<dom-module id="pebble-actions">
    <template>
        <style include="pebble-styles-shared"></style>
        <style include="iron-flex"></style>
        <style is="custom-style">
            #actions {
                --pebble-button: {
                    height: 32px;
                    padding: 0;
                    margin: 0;
                    border: 1px solid var(--palette-kelly-green);
                    font-size: small;
                    font-weight:500 !important;
                    color:var(--white);
                    background-color:var(--palette-kelly-green);
                    @apply(--pebble-actions-button);
                    color: var(--palette-white);
                }
                --pebble-button-left-icon: {
                    height: 20px;
                    width: 20px ;
                    padding:0px;
                    color: var(--icon-color);
                    @apply(--pebble-actions-button-icon);
                }
                --pebble-button-dropdown-icon: {
                    height: 20px;
                    width: 20px;
                    color: var(--palette-white);
                    margin: 0 5px;
                    @apply(--pebble-actions-button-drop-down-icon);
                }
            }
            #actionsPopover {
                margin-top: 3px;
                width: 250px!important;
                @apply(--pebble-actions-popover);
            }
            pebble-popover paper-item {
                cursor: pointer;
                font-size: var(--default-font-size);
                padding: 5px 10px 5px 10px;
                min-height: 40px;
            }

            pebble-popover paper-item iron-icon {
                --iron-icon-width: 18px;
                --iron-icon-height: 18px;
                color: var(--palette-white, #fff);
            }
            .badge {
                @apply(--layout);
                @apply(--layout-center-center);
                @apply(--paper-font-common-base);
                font-weight: normal;
                font-size: var(--font-size-small);
                border-radius: 50%;
                margin-right: 10px;
                width: 25px;
                height: 25px;
                background-color: var(--palette-medium-green);
                opacity: 1.0;
                color: var(--palette-white, #fff);
            }
            paper-item:hover{
                background-color:var(--bgColor-hover);
                font-weight: var(--font-medium, 500);
            }
            #actionItem{
                overflow: hidden;
                text-overflow: ellipsis;
            }    
            .actionPopoverTitle{
                text-align:center;
                font-size:var(--font-size-small);
                color:var(--dark-title-color);
                height: 30px;
                line-height: 24px;
                font-weight: var(--font-medium, 500);
            }          
         </style>
        <pebble-button id="actions" icon="[[buttonIcon]]" button-text="[[buttonText]]" noink dropdown-icon on-tap="_onActionsTap"></pebble-button>
            <pebble-popover id="actionsPopover" for="actions" auto-fit-on-attach no-overlap horizontal-align="right">
                 <div class="actionPopoverTitle">Create New Product</div>
                <template is="dom-repeat" items="[[actionsData]]" as="action">
                    <paper-item data="[[action]]" on-tap="_onActionItemTap">
                        <template is="dom-if" if="[[action.icon]]">
                            <iron-icon icon="[[action.icon]]" class="pebble-xl-icons m-r-10"></iron-icon>
                        </template>
                        <div id="actionItem">
                            <template is="dom-if" if="[[action.text]]">
                                [[action.text]]
                            </template>
                        </div>
                    </paper-item>
                </template>
            </pebble-popover>
    </template>
    <script>
        (function() {
            'use strict';

            Polymer({
                is: "pebble-actions",

                properties: {
                    /**
                    * Indicates an action items data.
                    */
                    actionsData: {
                        type: Array,
                        value: function() { return []; }
                    },
                    /**
                    * Indicates an optional icon to be placed on the left side to the button text.
                    */
                    buttonIcon: {
                        type: String,
                        value: function() { return null; }
                    },
                    /**
                    * Indicates the text of the button.
                    */
                    buttonText: {
                        type: String,
                        value: function() { return null; }
                    }
                },
                behaviors: [
                    RUFBehaviors.UIBehavior
                ],
                _onActionsTap: function (e) {
                    this.$$('#actionsPopover').show();
                },
                _onActionItemTap: function (e) {
                    var eventName = "pebble-actions-action-click";
                    var eventDetail = {
                        name: eventName,
                        data: e.currentTarget.data
                    }
                    this.fireBedrockEvent(eventName, eventDetail,{ ignoreId: true });
                    this.$$('#actionsPopover').hide();
                }
            });
        })();
    </script>
</dom-module>