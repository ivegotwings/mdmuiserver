<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../pebble-textbox/pebble-textbox.html">
<link rel="import" href="../pebble-textarea/pebble-textarea.html">
<link rel="import" href="../pebble-dropdown/pebble-dropdown.html">
<link rel="import" href="../pebble-boolean/pebble-boolean.html">

<!--
`pebble-attribute`
Attribute control for riversand ui framework

@demo demo/index.html 
-->

<dom-module id="pebble-attribute">
  <template>
    <style include="shared-styles"></style>
    <template is="dom-if" if="[[_isEditMode(mode)]]">
      <template is="dom-if" if="[[_isTextBox(attributeModelObject.displayType)]]">
        <pebble-textbox 
        label="{{attributeModelObject.longName}}" value="{{attributeObject.value}}"
        required="[[attributeModelObject.required]]" 
        minlength="[[attributeModelObject.minLength]]" maxlength="[[attributeModelObject.maxLength]]"
        auto-validate="true"
        ></pebble-textbox>
      </template>
      <template is="dom-if" if="[[_isTextArea(attributeModelObject.displayType)]]">
        <pebble-textarea 
        label="{{attributeModelObject.longName}}" value="{{attributeObject.value}}"
        required="[[attributeModelObject.required]]"
        minlength="[[attributeModelObject.minLength]]" maxlength="[[attributeModelObject.maxLength]]"
        ></pebble-textarea>
      </template>
      <template is="dom-if" if="[[_isDropDown(attributeModelObject.displayType)]]">
        <pebble-dropdown label="{{attributeModelObject.longName}}" items="{{attributeModelObject.allowedValues}}" selected-value="{{attributeObject.value}}"></pebble-dropdown>
      </template>
       <template is="dom-if" if="[[_isBoolean(attributeModelObject.displayType)]]">
        <pebble-boolean label="{{attributeModelObject.longName}}" value="{{attributeObject.value}}"></pebble-boolean>
      </template>
    </template>
    <template is="dom-if" if="[[!_isEditMode(mode)]]">
      <br>
      <div style="clear:both;padding-top:5px"><span>{{attributeModelObject.longName}}:</span><span style="font-weight:bold"> {{attributeObject.value}}</span><br></div>
    </template>
  </template>

  <script>
    (function() {
      'use strict';

      Polymer({
        is: 'pebble-attribute',
        properties: {
          // name: {
          //   type: String,
          //   value: ""
          // },
          // displayType: {
          //   type: String,
          //   value: ""
          // },
          // allowedValues: {
          //   type: String,
          //   value: ""
          // },
          mode: {
            type: String,
            value: "view"
          },
          attributeObject: {
            type: Object,
            value: function (){
              return {};
            },
            notify: true
          },
          attributeModelObject: {
            type: Object,
            value: function (){
              return {};
            }
          }
        },
        _isEditMode: function(mode) {
          return mode === "edit";
        },
        _onChange: function(event) {
          //todo: this is not working right now, have to find out how to propagate change event up the control hierarchy
          if (this.shadowRoot) {
            this.fire(event.type, {
              sourceEvent: event
            }, {
              node: this,
              bubbles: event.bubbles,
              cancelable: event.cancelable
            });
          }
        },
        _isTextBox: function(displayType) {
          return displayType === "textbox";
        },
        _isTextArea: function(displayType) {
          return displayType === "textarea";
        },
        _isDropDown: function(displayType) {
          return displayType === "dropdown";
        },
        _isBoolean: function(displayType) {
          return displayType === "boolean";
        }
      });
    })();
  </script>

</dom-module>