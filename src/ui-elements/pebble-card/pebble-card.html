<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../paper-material/paper-material.html">
<link rel="import" href="../paper-styles/default-theme.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icons/communication-icons.html">
<link rel="import" href="../iron-icons/hardware-icons.html">
<link rel="import" href="../iron-icons/social-icons.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-menu/paper-menu.html">
<link rel="import" href="../paper-item/paper-item.html">

<!--
` <pebble-card> ` Represents a container with a drop shadow. 
  They may contain a photo, text, and a link about a single subject. 
  They may display content containing elements of varying size, such as notification list or charts.

@demo demo/index.html 
-->

<dom-module id="pebble-card">
	<template>

		<style include="shared-styles"></style>
		<style include="paper-material">
			:host {
				display: inline-block;
				position: relative;
				box-sizing: border-box;
				background-color: var(--paper-card-background-color, --primary-background-color);
				border-radius: 2px;
				@apply(--paper-font-common-base);
				/*@apply(--paper-card);*/
			}
			/* IE 10 support for HTML5 hidden attr */
			
			[hidden] {
				display: none !important;
			}
			
			.header {
				position: relative;
				border-top-left-radius: inherit;
				border-top-right-radius: inherit;
				overflow: hidden;
				/* @apply(--paper-card-header); */
				@apply(--layout-horizontal);
				width: 100%;
			}
			
			.header iron-icon {
				@apply(--layout-start);
			}
			
			.header .title-text {
				padding: 16px;
				font-size: 24px;
				font-weight: 400;
				color: var(--paper-card-header-color, #000);
				@apply(--paper-card-header-text);
				@apply(--layout-flex);
			}
			
			.header .title-text.over-image {
				position: absolute;
				bottom: 0px;
				@apply(--paper-card-header-image-text);
			}
			
			:host::content .card-content {
				padding: 16px;
				position: relative;
				@apply(--paper-card-content);
			}
			
			:host::content .card-actions {
				border-top: 1px solid #e8e8e8;
				padding: 5px 16px;
				position: relative;
				@apply(--paper-card-actions);
			}
			
			:host .card-icons {
				padding: 12px;
			}
			
			:host paper-icon-button {
				color: var(--paper-grey-600);
				width: 24px;
				height: 24px;
				padding: 4px;
			}
			
			:host paper-icon-button.white {
				color: white !important;
			}
			
			:host paper-item {
				cursor: pointer;
			}
		</style>

		<paper-material elevation="1">
			<div class="header">
				<div hidden$="[[!heading]]" class="title-text">
					<iron-icon class="big" icon="[[headerIcon]]"></iron-icon> [[heading]]
				</div>
				<div class="card-icons">
					<template is="dom-if" if="[[!nonMaximizable]]">
						<paper-icon-button name="maximize" icon="icons:fullscreen" title="Maximize" on-tap="_onMaximizeClick"></paper-icon-button>
					</template>
					<template is="dom-if" if="[[!nonClosable]]">
						<paper-icon-button name="remove" icon="icons:clear" title="Remove" on-tap="_onRemoveClick"></paper-icon-button>
					</template>
					<template is="dom-if" if="[[iconButtons]]">
						<paper-menu-button>
							<paper-icon-button class="dropdown-trigger" name="more" icon="icons:more-vert" title="More options"></paper-icon-button>
							<paper-menu class="dropdown-content">
								<template is="dom-repeat" items="[[iconButtons]]">
									<paper-item name="[[item.name]]" on-tap="_onIconButtonClick">[[item.label]]</paper-item>
								</template>
							</paper-menu>
						</paper-menu-button>
					</template>
				</div>
			</div>

			<content></content>
		</paper-material>
	</template>

	<script>
    (function() {
      'use strict';

      Polymer({
        is: 'pebble-card',
        ready: function(){
        },
        properties: {
					/**
           * Indicates title of the card.
           * 
					 */
          heading: {
            type: String,
            value: "Card Heading"
          },
					/**
           * Indicates the url of the title image of the card.
           * 
					 */
          headerIcon: {
            type: String,
            value: "icons:dashboard"
          },
					/**
           * Specifies whether the card container can be closed or not.
					 * If it is set to <b>true</b>, then the card container cannot be closed.
           * 
					 */
          nonClosable : {
            type: Boolean,
            value: false
          },
					/**
           * Specifies whether the card container can be maximized or not.
					 * If it is set to <b>true</b>, then the card container cannot be maximized.
           * 
				   */
          nonMaximizable : {
            type: Boolean,
            value: false
          },
					/**
          * Specifies whether the card container's position can be dragged or not.
					* If it is set to <b>true</b>, then the card is not draggable.
          * 
					*/
          nonDraggable : {
            type: Boolean,
            value: false
          },
					/**
          * Indicates the list of actions available in "more" icon on top right corner of the card.
          * 
					*/
          iconButtons: {
            type: Array,
            value: function() { return null; }
          }
        },
        _onIconButtonClick: function(e) {
          var targetName = e.target.name;
          //when clicking on the atcual icon, the target is iron icon, 
          //when clicking outside edge of icon the target is paper icon button
          if(e.target.tagName == "IRON-ICON"){
            targetName = e.path[1].name;
          }
          for(var i=0;i<this.iconButtons.length;i++){
            if(this.iconButtons[i].name == targetName){
              eval(this.iconButtons[i].click);
            }
          }
        },
        _onMaximizeClick: function(e) {
          alert('_onMaximizeClick');
        },
        _onRemoveClick: function(e) {
          alert('_onRemoveClick');
        }
      });
    })();
  </script>

</dom-module>